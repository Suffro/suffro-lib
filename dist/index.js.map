{"version":3,"sources":["../src/_regexPatterns.ts","../src/_typesValidation.ts","../src/_utils.ts","../src/_pageStore.ts","../src/_logger.ts","../src/_browserStorage.ts","../node_modules/idb/build/wrap-idb-value.js","../node_modules/idb/build/index.js","../src/_idb.ts","../src/_crypto.ts","../src/appConfig/_config.ts","../src/firebase/_reCaptchaVerifier.ts","../src/firebase/storage/_methods.ts","../src/firebase/auth/_methods.ts","../src/firebase/auth/_authState.ts","../src/firebase/firestore/_methods.ts","../src/firebase/firestore/_firestoreTypesValidation.ts","../src/firebase/_client.ts","../src/firebase/_init.ts","../src/_jitter.ts","../src/_integerUtils.ts","../src/_json.ts"],"sourcesContent":["\n// ===== Generice sensitive data =====\nexport const RE_WS = /\\s+/g;\nexport const RE_QUERY_SENSITIVE = /([?&])(token|api[_-]?key|key|signature|password|pass|pwd|code|secret|client[_-]?secret|access[_-]?token)=([^&#\\s]+)/gi;\nexport const RE_AUTH = /\\b(authorization|bearer|basic)\\b[: ]+\\S+/gi;\nexport const RE_AWS_ACCESS_KEY = /\\bAKIA[0-9A-Z]{16}\\b/g;\nexport const RE_SECRET40 = /\\b[A-Za-z0-9/+]{40}\\b/g; // may overmatch harmless 40-char base64\nexport const RE_LONG_DIGITS = /\\b(?:\\d[ -]?){13,19}\\b/g; // potential cards/accounts\nexport const RE_IPV4_NOLB = /(^|[^0-9])((?:\\d{1,3}\\.){3}\\d{1,3})(?!\\d)/g; // no lookbehind\nexport const RE_PATH_SECRET = /\\/(token|key|secret|signature|passwd|password|code)\\/[^\\/?#\\s]+/gi;\nexport const RE_PEM_BLOCK = /-----BEGIN [A-Z ]+-----[\\s\\S]*?-----END [A-Z ]+-----/g;\n\n// ===== Text / tokens =====\nexport const RE_WHITESPACE = /\\s+/g;\nexport const RE_NON_WORD = /\\W+/g;\nexport const RE_SLUG = /^[a-z0-9]+(?:-[a-z0-9]+)*$/;\nexport const RE_USERNAME_SIMPLE = /^[A-Z0-9_]{3,20}$/i;\nexport const RE_HASHTAG = /(^|\\s)#([A-Z0-9_]{1,30})/gi;\nexport const RE_MENTION = /(^|[^@\\w])@([A-Z0-9_]{1,30})/gi;\n\n// ===== Numbers / formats =====\nexport const RE_INT = /^[+-]?\\d+$/;\nexport const RE_FLOAT = /^[+-]?(?:\\d+\\.?\\d*|\\.\\d+)(?:[eE][+-]?\\d+)?$/;\nexport const RE_NUMBER_THOUSANDS = /^-?\\d{1,3}(?:[.,]\\d{3})*(?:[.,]\\d+)?$/;\nexport const RE_HEX_PREFIXED = /^0x[0-9A-F]+$/i;\n\n// ===== Colors (CSS) =====\nexport const RE_HEX_COLOR = /^#(?:[0-9A-F]{3}|[0-9A-F]{6}|[0-9A-F]{8})$/i;\nexport const RE_RGB = /^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/i;\nexport const RE_RGBA = /^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(0|1|0?\\.\\d+)\\s*\\)$/i;\nexport const RE_HSL = /^hsl\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})%\\s*,\\s*(\\d{1,3})%\\s*\\)$/i;\nexport const RE_HSLA = /^hsla\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})%\\s*,\\s*(\\d{1,3})%\\s*,\\s*(0|1|0?\\.\\d+)\\s*\\)$/i;\n\n// ===== Web / networking =====\nexport const RE_EMAIL = /\\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}\\b/gi;\nexport const RE_DOMAIN = /^(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+[A-Z]{2,}$/i;\nexport const RE_URL_HTTP = /^(https?:\\/\\/)[^\\s/$.?#].[^\\s]*$/i;\nexport const RE_URL_SIMPLE = /^(https?:\\/\\/)?(?:[A-Z0-9-]+\\.)+[A-Z]{2,}(?:\\/[^\\s]*)?$/i;\nexport const RE_IPV4 = /^(?:25[0-5]|2[0-4]\\d|1?\\d?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1?\\d?\\d)){3}$/;\nexport const RE_IPV6_SIMPLE = /^([A-F0-9]{1,4}:){7}[A-F0-9]{1,4}$/i; // no '::' compression\nexport const RE_MAC = /^([0-9A-F]{2}[:-]){5}[0-9A-F]{2}$/i;\nexport const RE_HOSTPORT = /^(?:\\[(?:[A-F0-9:]+)\\]|(?:\\d{1,3}\\.){3}\\d{1,3}|(?:[A-Z0-9-]+\\.)+[A-Z]{2,})(?::\\d{1,5})?$/i;\nexport const RE_E164_PHONE = /^\\+?[1-9]\\d{1,14}$/;\n\n// ===== Dates / times =====\nexport const RE_DATE_ISO = /^\\d{4}-\\d{2}-\\d{2}$/;\nexport const RE_TIME_24H = /^(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d)?$/;\nexport const RE_TIME_12H = /^(?:0?[1-9]|1[0-2]):[0-5]\\d(?::[0-5]\\d)?\\s?(?:AM|PM)$/i;\nexport const RE_DATETIME_ISO = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?(?:Z|[+-]\\d{2}:\\d{2})$/;\nexport const RE_DATE_DDMMYYYY = /^(0?[1-9]|[12]\\d|3[01])[\\/.-](0?[1-9]|1[0-2])[\\/.-]\\d{4}$/;\nexport const RE_DATE_MMDDYYYY = /^(0?[1-9]|1[0-2])[\\/.-](0?[1-9]|[12]\\d|3[01])[\\/.-]\\d{4}$/;\nexport const RE_TZ_OFFSET = /^[+-](?:0\\d|1[0-4]):[0-5]\\d$/; // ±HH:MM (up to 14)\n\n// ===== Identifiers / encodings =====\nexport const RE_UUID_ANY = /^[0-9A-F]{8}-[0-9A-F]{4}-[1-5][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i;\nexport const RE_UUID_V4 = /^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i;\nexport const RE_ULID = /^[0-9A-HJKMNP-TV-Z]{26}$/i;\nexport const RE_BASE64 = /^(?:[A-Z0-9+\\/]{4})*(?:[A-Z0-9+\\/]{2}==|[A-Z0-9+\\/]{3}=)?$/i;\nexport const RE_JWT = /\\b([A-Za-z0-9-_]{10,})\\.([A-Za-z0-9-_]{10,})(?:\\.([A-Za-z0-9-_]{5,}))?\\b/g;\nexport const RE_SHA1 = /^[A-F0-9]{40}$/i;\nexport const RE_SHA256 = /^[A-F0-9]{64}$/i;\nexport const RE_GIT_COMMIT = /^[0-9A-F]{7,40}$/i;\nexport const RE_IBAN_GENERIC = /^[A-Z]{2}\\d{2}[A-Z0-9]{1,30}$/;\n\n// ===== Payment-like (approximate) =====\nexport const RE_CREDITCARD_GENERIC = /^(?:4\\d{12}(?:\\d{3})?|5[1-5]\\d{14}|3[47]\\d{13}|3(?:0[0-5]|[68]\\d)\\d{11}|6(?:011|5\\d{2})\\d{12})$/;\nexport const RE_VISA = /^4\\d{12}(\\d{3})?$/;\nexport const RE_MASTERCARD = /^(5[1-5]\\d{14}|2(?:2[2-9]\\d|[3-6]\\d{2}|7(?:[01]\\d|20))\\d{12})$/;\n\n// ===== Currency / amounts =====\nexport const RE_CURRENCY_GENERIC = /^(?:[A-Z]{3}|[$€£])\\s?\\d{1,3}(?:[.,]\\d{3})*(?:[.,]\\d{2})?$/;\nexport const RE_PERCENT = /^(?:100(?:\\.0+)?|(?:\\d{1,2})(?:\\.\\d+)?)%$/;\n\n// ===== Postal codes (examples) =====\nexport const RE_ZIP_US = /^\\d{5}(?:-\\d{4})?$/;\nexport const RE_CAP_IT = /^\\d{5}$/;\nexport const RE_POSTCODE_UK_APPROX = /^[A-Z]{1,2}\\d[A-Z\\d]?\\s?\\d[A-Z]{2}$/i;\n\n// ===== File paths / names =====\nexport const RE_FILENAME_SAFE = /^[A-Z0-9._-]+$/i;\nexport const RE_UNIX_PATH = /^(\\/[^/\\0]+)+\\/?$/;\nexport const RE_WINDOWS_PATH = /^(?:[A-Z]:\\\\|\\\\\\\\)[^\\s<>:\"|?*]+$/i;\nexport const RE_EXTENSION = /^[^.]+\\.[A-Z0-9]+$/i;\nexport const RE_MIME_TYPE = /^[a-z]+\\/[a-z0-9+.-]+$/i;\n\n// ===== Coordinates =====\nexport const RE_LAT = /^-?(?:[1-8]?\\d(?:\\.\\d+)?|90(?:\\.0+)?)$/;\nexport const RE_LON = /^-?(?:1[0-7]\\d(?:\\.\\d+)?|[1-9]?\\d(?:\\.\\d+)?|180(?:\\.0+)?)$/;\nexport const RE_LATLON_PAIR = /^\\s*-?\\d+(?:\\.\\d+)?\\s*,\\s*-?\\d+(?:\\.\\d+)?\\s*$/;\n\n// ===== Case styles =====\nexport const RE_CAMEL_CASE = /^(?:[a-z]+(?:[A-Z][a-z0-9]+)*)$/;\nexport const RE_PASCAL_CASE = /^(?:[A-Z][a-z0-9]+)+$/;\nexport const RE_SNAKE_CASE = /^[a-z0-9]+(?:_[a-z0-9]+)+$/;\nexport const RE_KEBAB_CASE = /^[a-z0-9]+(?:-[a-z0-9]+)+$/;\n\n// ===== HTML / CSV =====\nexport const RE_HTML_TAG = /<[^>]+>/;\nexport const RE_CSV_LINE = /^(?:\"[^\"]*\"|[^\",]*)(?:,(?:\"[^\"]*\"|[^\",]*))*$/;\n\n// ===== Password policy (example) =====\nexport const RE_PASSWORD_STRONG = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[^A-Za-z0-9]).{8,}$/;\n\n// ===== IP addresses =====\nexport const RE_IPV6 = /^((?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}|(?:[A-F0-9]{1,4}:){1,7}:|(?:[A-F0-9]{1,4}:){1,6}:[A-F0-9]{1,4}|(?:[A-F0-9]{1,4}:){1,5}(?::[A-F0-9]{1,4}){1,2}|(?:[A-F0-9]{1,4}:){1,4}(?::[A-F0-9]{1,4}){1,3}|(?:[A-F0-9]{1,4}:){1,3}(?::[A-F0-9]{1,4}){1,4}|(?:[A-F0-9]{1,4}:){1,2}(?::[A-F0-9]{1,4}){1,5}|[A-F0-9]{1,4}:(?::[A-F0-9]{1,4}){1,6}|:(?::[A-F0-9]{1,4}){1,7})(?:%\\w+)?$/i; // compressed + zone id\n\n// ===== Italy: Codice Fiscale & Partita IVA =====\n// Strict (no \"omocodia\" substitutions)\nexport const RE_CF_IT_STRICT = /^[A-Z]{6}\\d{2}[A-EHLMPRST]\\d{2}[A-Z]\\d{3}[A-Z]$/;\n// Omocodia allowed (L,M,N,P,Q,R,S,T,U,V standing in for digits)\nexport const RE_CF_IT_OMOCODIA = /^[A-Z]{6}[0-9LMNPQRSTUV]{2}[A-EHLMPRST][0-9LMNPQRSTUV]{2}[A-Z][0-9LMNPQRSTUV]{3}[A-Z]$/;\n// Partita IVA (11 digits), with optional \"IT\" prefix\nexport const RE_PIVA_IT = /^(?:IT\\s*)?\\d{11}$/i;\n\n// ===== PEC (Posta Elettronica Certificata) =====\nexport const RE_PEC_IT_STRICT = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.PEC\\.IT$/i;     // ends with .pec.it\nexport const RE_PEC_GENERIC = /^[A-Z0-9._%+-]+@[A-Z0-9.-]*\\.PEC\\.[A-Z]{2,}$/i; // any TLD with \".pec.\"\n\n// ===== EU VAT (per country; pragmatic patterns) =====\nexport const RE_VAT_AT = /^ATU\\d{8}$/;                    // Austria\nexport const RE_VAT_BE = /^BE0?\\d{9}$/;                   // Belgium\nexport const RE_VAT_BG = /^BG\\d{9,10}$/;                  // Bulgaria\nexport const RE_VAT_HR = /^HR\\d{11}$/;                    // Croatia\nexport const RE_VAT_CY = /^CY\\d{8}[A-Z]$/i;              // Cyprus\nexport const RE_VAT_CZ = /^CZ\\d{8,10}$/;                  // Czechia\nexport const RE_VAT_DK = /^DK\\d{8}$/;                     // Denmark\nexport const RE_VAT_EE = /^EE\\d{9}$/;                     // Estonia\nexport const RE_VAT_FI = /^FI\\d{8}$/;                     // Finland\nexport const RE_VAT_FR = /^FR[0-9A-Z]{2}\\d{9}$/i;         // France (2-char key + 9 digits)\nexport const RE_VAT_DE = /^DE\\d{9}$/;                     // Germany\nexport const RE_VAT_EL = /^EL\\d{9}$/;                     // Greece (EL)\nexport const RE_VAT_HU = /^HU\\d{8}$/;                     // Hungary\nexport const RE_VAT_IE = /^IE\\d{7}[A-W][A-I]?$/i;         // Ireland (approx)\nexport const RE_VAT_IT = /^IT\\d{11}$/;                    // Italy\nexport const RE_VAT_LV = /^LV\\d{11}$/;                    // Latvia\nexport const RE_VAT_LT = /^LT(\\d{9}|\\d{12})$/;            // Lithuania\nexport const RE_VAT_LU = /^LU\\d{8}$/;                     // Luxembourg\nexport const RE_VAT_MT = /^MT\\d{8}$/;                     // Malta\nexport const RE_VAT_NL = /^NL\\d{9}B\\d{2}$/;               // Netherlands\nexport const RE_VAT_PL = /^PL\\d{10}$/;                    // Poland\nexport const RE_VAT_PT = /^PT\\d{9}$/;                     // Portugal\nexport const RE_VAT_RO = /^RO\\d{2,10}$/;                  // Romania\nexport const RE_VAT_SK = /^SK\\d{10}$/;                    // Slovakia\nexport const RE_VAT_SI = /^SI\\d{8}$/;                     // Slovenia\nexport const RE_VAT_ES = /^ES[A-Z0-9]\\d{7}[A-Z0-9]$/i;    // Spain\nexport const RE_VAT_SE = /^SE\\d{12}$/;                    // Sweden\n\n// ===== S3 / R2 object URLs & URIs =====\n// S3 URI like: s3://bucket/key\nexport const RE_S3_URI = /^s3:\\/\\/[a-z0-9][a-z0-9.-]{1,61}[a-z0-9]\\/.+$/;\n// S3 virtual-hosted–style: https://bucket.s3.amazonaws.com/key (any region suffix acceptable)\nexport const RE_S3_VHOST_URL = /^https?:\\/\\/[a-z0-9][a-z0-9.-]{1,61}[a-z0-9]\\.s3[.-][a-z0-9-]+\\.amazonaws\\.com\\/.+$/i;\n// S3 path-style: https://s3.region.amazonaws.com/bucket/key\nexport const RE_S3_PATH_URL = /^https?:\\/\\/s3[.-][a-z0-9-]+\\.amazonaws\\.com\\/[a-z0-9][a-z0-9.-]{1,61}[a-z0-9]\\/.+$/i;\n// R2 public (account endpoint): https://<accountid>.r2.cloudflarestorage.com/bucket/key\nexport const RE_R2_PUBLIC_URL = /^https?:\\/\\/[a-z0-9]{32}\\.r2\\.cloudflarestorage\\.com\\/[A-Za-z0-9._-]{3,63}\\/.+$/;\n// R2 S3-compatible (custom endpoint host): https?:\\/\\/<host>/bucket/key  — keep broad\nexport const RE_R2_S3_COMPAT_URL = /^https?:\\/\\/[A-Z0-9.-]+\\/[A-Za-z0-9._-]{3,63}\\/.+$/i;\n\n// ===== SemVer (versions & ranges) =====\n// Exact SemVer (same as before, strict)\nexport const RE_SEMVER = /^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?(?:\\+[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?$/i;\n// Simple ranges with ^ or ~ and OR (pragmatic)\nexport const RE_SEMVER_RANGE_SIMPLE = /^(?:[~^]?\\d+\\.\\d+\\.\\d+(?:-[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?(?:\\+[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?)(?:\\s*\\|\\|\\s*[~^]?\\d+\\.\\d+\\.\\d+(?:-[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?(?:\\+[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?)*$/i;\n// Comparators like >=1.2.3 <2.0.0 (basic)\nexport const RE_SEMVER_RANGE_COMPARATORS = /^(?:[<>]=?\\s*\\d+\\.\\d+\\.\\d+(?:-[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?(?:\\+[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?\\s*)+(?:\\|\\|\\s*(?:[<>]=?\\s*\\d+\\.\\d+\\.\\d+(?:-[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?(?:\\+[0-9A-Z-]+(?:\\.[0-9A-Z-]+)*)?\\s*)+)*$/i;\n","// ------------------ helpers ------------------\nfunction validateUrl(input: string): boolean {\n  if (typeof input !== \"string\") return false;\n  const s = input.trim();\n  if (s.length === 0) return false;\n  try {\n    new URL(s); // richiede schema (es. https://)\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nfunction isValidDateString(value: string): boolean {\n  if (typeof value !== \"string\") return false;\n  const d = new Date(value);\n  return !Number.isNaN(d.getTime());\n}\n\nfunction isValidDateObject(value: unknown): value is Date {\n  return value instanceof Date && !Number.isNaN(value.getTime());\n}\n\n\nconst ISO_DATE_RE = /^\\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])$/;\n// YYYY-MM-DDThh:mm(:ss(.sss)?)?(Z|±HH:MM)\nconst ISO_DATETIME_RE =\n  /^\\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])T([01]\\d|2[0-3]):([0-5]\\d)(?::([0-5]\\d)(\\.\\d{1,3})?)?(Z|[+\\-](?:[01]\\d|2[0-3]):?[0-5]\\d)$/;\n\nfunction isIsoDateString(value: string): boolean {\n  if (typeof value !== \"string\" || !ISO_DATE_RE.test(value)) return false;\n  // validazione calendario: costruisci la data e verifica corrispondenza\n  const [y, m, d] = value.split(\"-\").map(Number);\n  const dt = new Date(Date.UTC(y, m - 1, d));\n  return (\n    dt.getUTCFullYear() === y &&\n    dt.getUTCMonth() === m - 1 &&\n    dt.getUTCDate() === d\n  );\n}\n\nfunction isIsoDateTimeString(value: string): boolean {\n  if (typeof value !== \"string\" || !ISO_DATETIME_RE.test(value)) return false;\n  const dt = new Date(value);\n  return !Number.isNaN(dt.getTime());\n}\n\n\n// RFC 5322-lite (pragmatico)\nconst EMAIL_RE = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n\n// UUID v1–v5\nconst UUID_RE = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n\n// #RGB o #RRGGBB\nconst HEX_COLOR_RE = /^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/;\n\n// IPv4\nconst IPV4_RE = /^(25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]?\\d)){3}$/;\n\n// IPv6 (compressa o piena) — accetta forme valide comuni\nconst IPV6_RE =\n  /^(([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}|(([0-9A-Fa-f]{1,4}:){1,7}:)|(([0-9A-Fa-f]{1,4}:){1,6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,5}(:[0-9A-Fa-f]{1,4}){1,2})|(([0-9A-Fa-f]{1,4}:){1,4}(:[0-9A-Fa-f]{1,4}){1,3})|(([0-9A-Fa-f]{1,4}:){1,3}(:[0-9A-Fa-f]{1,4}){1,4})|(([0-9A-Fa-f]{1,4}:){1,2}(:[0-9A-Fa-f]{1,4}){1,5})|([0-9A-Fa-f]{1,4}:((:[0-9A-Fa-f]{1,4}){1,6}))|(:((:[0-9A-Fa-f]{1,4}){1,7}|:)))(%[0-9A-Za-z]{1,})?$/;\n\ntype AnyFunc = (...args: any[]) => any;\ntype AsyncFunc = (...args: any[]) => Promise<any>;\ntype GenFunc = (...args: any[]) => Generator<any, any, any>;\n\n// ------------------ types ------------------\ninterface Validate {\n  // primitivi / base\n  string(v: unknown): v is string;\n  url(v: unknown): v is string;\n  nonEmptyString(v: unknown): v is string;\n\n  number(v: unknown): v is number;\n  integer(v: unknown): v is number;\n  boolean(v: unknown): v is boolean;\n  bigint(v: unknown): v is bigint;\n  symbol(v: unknown): v is symbol;\n\n  numeric(v: unknown): boolean;\n  finiteNumber(v: unknown): v is number;\n\n  // date\n  dateString(v: unknown): v is string;\n  date(v: unknown): v is Date;\n  isoDateString(v: unknown): v is string;\n  isoDateTimeString(v: unknown): v is string;\n\n  // null/undefined\n  null(v: unknown): v is null;\n  undefined(v: unknown): v is undefined;\n  defined<T>(v: T | null | undefined): v is T;\n  nan(v: unknown): v is number;\n\n  // oggetti/collezioni\n  object(v: unknown): v is Record<string, unknown>;\n  plainObject(v: unknown): v is Record<string, unknown>;\n  emptyObject(v: unknown): v is Record<string, never>;\n\n  array<T = unknown>(v: unknown): v is T[];\n  nonEmptyArray<T = unknown>(v: unknown): v is T[];\n\n  set<T = unknown>(v: unknown): v is Set<T>;\n  map<K = unknown, V = unknown>(v: unknown): v is Map<K, V>;\n  weakSet<T extends object = object>(v: unknown): v is WeakSet<T>;\n  weakMap<K extends object = object, V = unknown>(v: unknown): v is WeakMap<K, V>;\n\n  // binari / typed arrays\n  arrayBuffer(v: unknown): v is ArrayBuffer;\n  dataView(v: unknown): v is DataView;\n  typedArray(v: unknown): v is Exclude<ArrayBufferView, DataView>;\n\n  // regex / promise / function\n  regexp(v: unknown): v is RegExp;\n  promise<T = unknown>(v: unknown): v is Promise<T>;\n  function(v: unknown): v is AnyFunc;\n  asyncFunction(v: unknown): v is AsyncFunc;\n  generatorFunction(v: unknown): v is GenFunc;\n\n  // stringhe con pattern\n  email(v: unknown): v is string;\n  uuid(v: unknown): v is string;\n  hexColor(v: unknown): v is string;\n  ipv4(v: unknown): v is string;\n  ipv6(v: unknown): v is string;\n  jsonString(v: unknown): v is string;\n\n  // truthiness\n  truthy(v: unknown): boolean;\n  falsy(v: unknown): boolean;\n}\n\n// ------------------ implementation ------------------\nexport const validate: Validate = {\n  // base\n  string: (v): v is string => typeof v === \"string\",\n  url: (v): v is string => typeof v === \"string\" && validateUrl(v),\n  nonEmptyString: (v): v is string => typeof v === \"string\" && v.trim().length > 0,\n\n  number: (v): v is number => typeof v === \"number\" && !Number.isNaN(v),\n  integer: (v): v is number => typeof v === \"number\" && Number.isInteger(v),\n  boolean: (v): v is boolean => typeof v === \"boolean\",\n  bigint: (v): v is bigint => typeof v === \"bigint\",\n  symbol: (v): v is symbol => typeof v === \"symbol\",\n\n  numeric: (v): boolean => (typeof v === \"number\" ? !Number.isNaN(v) : !Number.isNaN(Number(v))),\n  finiteNumber: (v): v is number => typeof v === \"number\" && Number.isFinite(v),\n\n  // date\n  dateString: (v): v is string => typeof v === \"string\" && isValidDateString(v),\n  date: (v): v is Date => isValidDateObject(v),\n  isoDateString: (v): v is string => typeof v === \"string\" && isIsoDateString(v),\n  isoDateTimeString: (v): v is string => typeof v === \"string\" && isIsoDateTimeString(v),\n\n  // null/undefined\n  null: (v): v is null => v === null,\n  undefined: (v): v is undefined => typeof v === \"undefined\",\n  defined: <T>(v: T | null | undefined): v is T => v !== null && v !== undefined,\n  nan: (v): v is number => typeof v === \"number\" && Number.isNaN(v),\n\n  // oggetti/collezioni\n  object: (v): v is Record<string, unknown> => v !== null && typeof v === \"object\",\n  plainObject: (v): v is Record<string, unknown> => {\n    if (v === null || typeof v !== \"object\" || Array.isArray(v)) return false;\n    const proto = Object.getPrototypeOf(v);\n    return proto === Object.prototype || proto === null;\n  },\n  emptyObject: (v): v is Record<string, never> =>\n    v !== null && typeof v === \"object\" && !Array.isArray(v) && Object.keys(v).length === 0,\n\n  array: <T = unknown>(v: unknown): v is T[] => Array.isArray(v),\n  nonEmptyArray: <T = unknown>(v: unknown): v is T[] => Array.isArray(v) && v.length > 0,\n\n  set: <T = unknown>(v: unknown): v is Set<T> => v instanceof Set,\n  map: <K = unknown, V = unknown>(v: unknown): v is Map<K, V> => v instanceof Map,\n  weakSet: <T extends object = object>(v: unknown): v is WeakSet<T> => v instanceof WeakSet,\n  weakMap: <K extends object = object, V = unknown>(v: unknown): v is WeakMap<K, V> => v instanceof WeakMap,\n\n  // binari / typed arrays\n  arrayBuffer: (v): v is ArrayBuffer => v instanceof ArrayBuffer,\n  dataView: (v): v is DataView => v instanceof DataView,\n  typedArray: (v): v is Exclude<ArrayBufferView, DataView> =>\n    ArrayBuffer.isView(v) && !(v instanceof DataView),\n\n  // regex / promise / function\n  regexp: (v): v is RegExp => v instanceof RegExp,\n  promise: <T = unknown>(v: unknown): v is Promise<T> => !!v && typeof (v as any).then === \"function\",\n  function: (v): v is AnyFunc => typeof v === \"function\",\n  asyncFunction: (v): v is AsyncFunc =>\n    typeof v === \"function\" && (v as Function).constructor?.name === \"AsyncFunction\",\n  generatorFunction: (v): v is GenFunc =>\n    typeof v === \"function\" && (v as Function).constructor?.name === \"GeneratorFunction\",\n\n  // stringhe con pattern\n  email: (v): v is string => typeof v === \"string\" && EMAIL_RE.test(v),\n  uuid: (v): v is string => typeof v === \"string\" && UUID_RE.test(v),\n  hexColor: (v): v is string => typeof v === \"string\" && HEX_COLOR_RE.test(v),\n  ipv4: (v): v is string => typeof v === \"string\" && IPV4_RE.test(v),\n  ipv6: (v): v is string => typeof v === \"string\" && IPV6_RE.test(v),\n  jsonString: (v): v is string => {\n    if (typeof v !== \"string\") return false;\n    try { JSON.parse(v); return true; } catch { return false; }\n  },\n\n  // truthiness\n  truthy: (v): boolean => !!v,\n  falsy: (v): boolean => !v,\n};\n","import type { AnyObject, DropdownOption, HexColor, PasswordStrength } from \"./\";\nimport { logger } from \"./\";\nimport { RE_AUTH, RE_AWS_ACCESS_KEY, RE_EMAIL, RE_IPV4_NOLB, RE_JWT, RE_LONG_DIGITS, RE_PATH_SECRET, RE_PEM_BLOCK, RE_QUERY_SENSITIVE, RE_SECRET40, RE_WS } from \"./_regexPatterns\";\nimport { validate } from \"./_typesValidation\";\n\nexport const isBrowser = (): boolean => {\n  return typeof window !== \"undefined\" && typeof document !== \"undefined\";\n};\nexport const isWindowAvailable = (): boolean => {\n  return typeof window !== \"undefined\";\n};\nexport const isDev = (): boolean => {\n  const isLocalhost =\n    typeof window !== \"undefined\" &&\n    [\"localhost\", \"127.0.0.1\"].includes(window.location.hostname);\n\n  const nodeEnv = process?.env?.NODE_ENV;\n\n  return nodeEnv !== \"production\" || isLocalhost;\n};\n\nexport function stringStartsWith(\n  input: string,\n  prefix: string,\n  caseSensitive = false\n): boolean {\n  if (!caseSensitive) {\n    return input.toLowerCase().startsWith(prefix.toLowerCase());\n  }\n  return input.startsWith(prefix);\n}\n\ntype FileValidationResult = {\n  valid: boolean;\n  error?: string;\n};\n\n/**\n * Validates a file by checking its MIME type and maximum size.\n * @param file - The file to validate (can be null or undefined).\n * @param maxSizeMB - Maximum allowed size in MB (default: 2).\n * @param allowedTypes - Allowed MIME types (default: empty = all types allowed).\n * @returns Validation result object.\n */\nexport function validateFile(\n  file: File | Blob | null | undefined,\n  maxSizeMB: number = 2,\n  allowedTypes: string[] = []\n): FileValidationResult {\n  if (!file) {\n    return { valid: false, error: \"No file provided.\" };\n  }\n\n  const maxSizeBytes = maxSizeMB * 1024 * 1024;\n\n  // MIME type check (only if allowedTypes is not empty)\n  if (allowedTypes.length > 0 && !allowedTypes.includes(file.type)) {\n    return {\n      valid: false,\n      error: `Invalid file type. Allowed types: ${allowedTypes.join(\", \")}.`\n    };\n  }\n\n  // File size check\n  if (file.size > maxSizeBytes) {\n    return { valid: false, error: `File is too large. Max ${maxSizeMB} MB allowed.` };\n  }\n\n  return { valid: true };\n}\n\n\nexport function imageExistsAtURL(url: string, bustCache = true): Promise<boolean> {\n  return new Promise((resolve) => {\n    const img = new Image();\n    img.onload = () => resolve(true);\n    img.onerror = () => resolve(false);\n    img.referrerPolicy = \"no-referrer\";\n    img.src = bustCache\n      ? `${url}${url.includes(\"?\") ? \"&\" : \"?\"}_=${Date.now()}`\n      : url;\n  });\n}\n\n\nexport function clearUrl(input: string, domainOnly = false): string | null {\n  if (!validate.nonEmptyString(input)) {\n    console.error(`[invalid url string] ${input}`);\n    return null;\n  }\n\n  // Rimuove spazi iniziali/finali\n  let url = input.trim();\n\n  if (stringStartsWith(url, \"http://\"))\n    url = url?.replace(\"http://\", \"https://\");\n\n  // Se manca lo schema, aggiunge \"https://\"\n  if (!stringStartsWith(url, \"https://\")) url = \"https://\" + url;\n\n  try {\n    logger.log(`[url to clear] ${url}`);\n    const parsed = new URL(url);\n\n    // Facoltativo: normalizza schema e host in lowercase\n    parsed.protocol = parsed.protocol.toLowerCase();\n    parsed.hostname = parsed.hostname.toLowerCase();\n\n    // Rimuove slash finale superfluo\n    if (parsed.pathname.endsWith(\"/\") && parsed.pathname !== \"/\") {\n      parsed.pathname = parsed.pathname.slice(0, -1);\n    }\n    const urlParsed: string = parsed.toString();\n    if (!domainOnly) return urlParsed;\n    else return urlParsed?.replace(\"https://\", \"\");\n  } catch {\n    console.error(`[invalid url] ${input}`);\n    return null; // URL non valido\n  }\n}\n\n/**\n * Estrae il sottodominio da un URL o dal dominio corrente (es. builder.bubbledesk.app → \"builder\").\n *\n * ⚠️ Restituisce `null` se non è presente alcun sottodominio (es. bubbledesk.app o localhost).\n *\n * @param url - (opzionale) Una stringa URL da cui estrarre il sottodominio. Se non fornita, usa `window.location.hostname`.\n * @returns Il sottodominio come stringa, oppure `null` se non rilevabile.\n *\n * @example\n * getSubdomain(\"https://auth.bubbledesk.app\"); // \"auth\"\n * getSubdomain(); // se eseguito su builder.bubbledesk.app → \"builder\"\n * getSubdomain(\"https://bubbledesk.app\"); // null\n * getSubdomain(\"http://localhost:5173\"); // null\n */\nexport const getSubdomain = (url?: string): string | null => {\n  const hostname = url ? new URL(url).hostname : window.location.hostname;\n  const parts = hostname.split(\".\");\n\n  // Gestisce casi tipo: \"builder.bubbledesk.app\"\n  // Evita problemi su \"localhost\" o \"bubbledesk.app\"\n  if (parts.length >= 3) return parts[0];\n\n  return null;\n};\n\n/**\n *\n * @param options.reload If true, redirect url and related logic will be ignored\n */\nexport const redirectOrReload = (options?: {\n  redirectUrl?: string;\n  reload?: boolean;\n  redirectReplace?: boolean;\n}): void => {\n  if (options?.reload) window.location.reload();\n  if (!options?.reload && validate.nonEmptyString(options?.redirectUrl)) {\n    const redirectUrl = new URL(options?.redirectUrl);\n    if (redirectUrl?.href) {\n      switch (options?.redirectReplace) {\n        case true:\n          window.location.replace(redirectUrl?.href);\n          break;\n\n        default:\n          window.location.href = redirectUrl?.href;\n          break;\n      }\n    }\n  }\n};\n\nexport function checkPasswordStrength(password: string): PasswordStrength {\n  if (password.length < 8) return { text: \"very weak\", score: 0 };\n\n  let score = 0;\n\n  if (/[a-z]/.test(password)) score++; // lettere minuscole\n  if (/[A-Z]/.test(password)) score++; // lettere maiuscole\n  if (/\\d/.test(password)) score++; // numeri\n  if (/[^A-Za-z0-9]/.test(password)) score++; // simboli\n  if (password.length >= 12) score++; // lunghezza\n\n  switch (score) {\n    case 0:\n    case 1:\n      return { text: \"weak\", score: 1 };\n    case 2:\n      return { text: \"medium\", score: 2 };\n    case 3:\n      return { text: \"strong\", score: 3 };\n    case 4:\n    case 5:\n      return { text: \"very strong\", score: 4 };\n    default:\n      return { text: \"very weak\", score: 0 };\n  }\n}\n\nexport function capitalize(str: string): string {\n  if (!str) return \"\";\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nexport function formSubmit(callback: () => void | Promise<void>) {\n  return async (event: SubmitEvent) => {\n    event.preventDefault();\n    await callback();\n  };\n}\n\nexport function capitalizeEachWord(input: string): string {\n  return input\n    .toLowerCase()\n    .split(\" \")\n    .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(\" \");\n}\n\nexport function parseCookie(header: string): Record<string, string> {\n  return Object.fromEntries(header.split(\"; \").map((c) => c.split(\"=\")));\n}\n\nexport function isLocalhost(): boolean {\n  if (typeof window === \"undefined\") return false;\n\n  return window.location.hostname.startsWith(\"localhost\");\n}\n\nexport function getUrlParam(param: string): string | null {\n  if (typeof window === \"undefined\") return null;\n\n  const urlParams = new URLSearchParams(window.location.search);\n  return urlParams.get(param);\n}\n\nexport function sleep(seconds: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, seconds * 1000));\n}\n\nexport const removeWWW = (host: string | null): string | null => {\n  if (host && typeof host == \"string\") return host.replace(/^www\\./, \"\");\n  else return null;\n};\n\nexport function mapToObject(value: any): any {\n  try {\n    if (value instanceof Map) {\n      const obj: any = {};\n      for (const [key, val] of value.entries()) {\n        obj[key] = mapToObject(val);\n      }\n      return obj;\n    } else if (Array.isArray(value)) {\n      return value.map(mapToObject);\n    } else if (typeof value === \"object\" && value !== null) {\n      const obj: any = {};\n      for (const key in value) {\n        obj[key] = mapToObject(value[key]);\n      }\n      return obj;\n    } else {\n      return value;\n    }\n  } catch (error) {\n    logger.error(error);\n    return value;\n  }\n}\n\nexport function getRandomNumber(\n  min: number = 0,\n  max: number = 10000,\n  integer: boolean = true\n): number {\n  const rand = Math.random() * (max - min) + min;\n  return integer ? Math.floor(rand) : rand;\n}\n\nexport function getRandomString(options?: {\n  length?: number;\n  includeUppercase?: boolean;\n  prefix?: string;\n}): string {\n  const length = options?.length || 6;\n  const includeUppercase = options?.includeUppercase || true;\n\n  const lower = \"abcdefghijklmnopqrstuvwxyz\";\n  const digits = \"0123456789\";\n  const upper = includeUppercase ? lower.toUpperCase() : \"\";\n  const chars = lower + digits + upper;\n  let result = \"\";\n\n  for (let i = 0; i < length; i++) {\n    const randIndex = Math.floor(Math.random() * chars.length);\n    result += chars[randIndex];\n  }\n\n  if (options?.prefix) return `${options?.prefix}${result}`;\n  else return result;\n}\n\nexport function arrrayGetLast<T>(arr: T[]): T | undefined {\n  return arr.length > 0 ? arr[arr.length - 1] : undefined;\n}\n\nexport function getPathList(path?: string): string[] | null | undefined {\n  try {\n    if (path) return path.split(\"/\");\n    return window.location.pathname.split(\"/\");\n  } catch (error) {\n    logger.error(error);\n    return null;\n  }\n}\n\nexport function getCurrentPath(path?: string): string | null | undefined {\n  try {\n    let pathList = getPathList(path);\n    if (pathList) return arrrayGetLast(pathList);\n    else return null;\n  } catch (error) {\n    logger.error(error);\n    return null;\n  }\n}\n\nexport function buildPath(parts: string[], endIndex?: number): string {\n  const sliced = endIndex !== undefined ? parts.slice(0, endIndex + 1) : parts;\n  return \"/\" + sliced.filter(Boolean).join(\"/\");\n}\n\nexport function detectAnalysisFileType(filename: string): string {\n  const ext = filename.split(\".\").pop()?.toLowerCase();\n  switch (ext) {\n    case \"vcf\":\n    case \"fasta\":\n    case \"fa\":\n    case \"fastq\":\n    case \"fq\":\n    case \"gtf\":\n    case \"gff\":\n    case \"bed\":\n    case \"csv\":\n    case \"tsv\":\n      return ext;\n    default:\n      return \"unknown\";\n  }\n}\n\nexport function scrollToElement(\n  target: string | HTMLElement,\n  offset: number = 0,\n  scrollBehavior: ScrollBehavior = \"auto\"\n) {\n  let element: HTMLElement | null = null;\n\n  if (typeof target == \"string\") {\n    const normalizedId = target.startsWith(\"#\") ? target.slice(1) : target;\n    element = document.getElementById(normalizedId);\n  } else if (target instanceof HTMLElement) {\n    element = target;\n  }\n\n  if (!element) return;\n\n  const y = element.getBoundingClientRect().top + window.pageYOffset + offset;\n\n  window.scrollTo({\n    top: y,\n    behavior: scrollBehavior,\n  });\n}\n\nexport function clickOutside(node: HTMLElement, callback: () => void) {\n  const handleClick = (event: MouseEvent) => {\n    if (!node.contains(event.target as Node)) {\n      callback();\n    }\n  };\n\n  document.addEventListener(\"click\", handleClick, true);\n\n  return {\n    destroy() {\n      document.removeEventListener(\"click\", handleClick, true);\n    },\n  };\n}\n\nexport const setHiddenStatus = (\n  element: string | HTMLElement,\n  hidden: boolean\n) => {\n  let el: HTMLElement | null | undefined;\n  if (typeof element === \"string\") {\n    el = document.getElementById(element);\n  } else {\n    el = element;\n  }\n\n  if (!el) {\n    logger.error(\"Element is null running setHiddenStatus()\");\n    return;\n  }\n\n  if (hidden) {\n    el?.classList.add(\"hidden\");\n  } else {\n    el?.classList.remove(\"hidden\");\n    setTimeout(() => {\n      if (!el) return;\n      el.focus();\n    }, 100);\n  }\n};\n\nexport const toggleHiddenStatus = (element: string | HTMLElement) => {\n  let el: HTMLElement | null | undefined;\n  if (typeof element === \"string\") {\n    el = document.getElementById(element);\n  } else {\n    el = element;\n  }\n\n  if (!el) {\n    logger.error(\"Element is null running toggleHiddenStatus()\");\n    return;\n  }\n\n  const hasHidden = el?.classList.contains(\"hidden\");\n\n  if (!hasHidden) {\n    el?.classList.add(\"hidden\");\n  } else {\n    el?.classList.remove(\"hidden\");\n    setTimeout(() => {\n      if (!el) return;\n      el.focus();\n    }, 100);\n  }\n};\n\nexport function toHtmlId(str: string): string {\n  return str\n    .toLowerCase()\n    .trim()\n    .replace(/\\s+/g, \"-\") // replace spaces with hyphens\n    .replace(/[^a-z0-9\\-_]/g, \"\") // remove invalid characters\n    .replace(/^-+|-+$/g, \"\"); // remove leading/trailing hyphens\n}\n\nexport function toggleArrayItem<T>(array: T[], item: T): T[] {\n  return array.includes(item)\n    ? array.filter((i) => i !== item) // remove if exists\n    : [...array, item]; // add if not present\n}\n\nexport function updateUniqueArray<T>(\n  array: T[],\n  item: T,\n  action: \"add\" | \"remove\"\n): T[] {\n  if (action === \"add\") {\n    return array.includes(item) ? array : [...array, item];\n  } else {\n    return array.filter((i) => i !== item);\n  }\n}\n\nexport function updateArrayByKey<T, K extends keyof T>(\n  array: T[],\n  item: T,\n  action: \"add\" | \"remove\",\n  key?: K\n): T[] {\n  const referenceKey = (key || \"id\") as K;\n\n  const index = array.findIndex(\n    (el) => el[referenceKey] === item[referenceKey]\n  );\n\n  if (action === \"add\") {\n    if (index === -1) {\n      return [...array, item];\n    }\n    return array;\n  }\n\n  if (action === \"remove\") {\n    if (index > -1) {\n      return [...array.slice(0, index), ...array.slice(index + 1)];\n    }\n    return array;\n  }\n\n  throw new Error(`Unknown action: ${action}`);\n}\n\nexport function toCamelCase(input: string): string {\n  // Normalize separators to space\n  const normalized = input.replace(/[_\\-\\s]+/g, \" \").trim();\n\n  // Split by space first\n  const roughWords = normalized.split(\" \");\n\n  const words: string[] = [];\n\n  for (const segment of roughWords) {\n    // Split segment by camel case and acronym boundaries\n    const parts = segment.match(\n      /([A-Z]+(?=[A-Z][a-z]))|([A-Z]?[a-z]+)|([A-Z]+)|(\\d+)/g\n    );\n    if (parts) words.push(...parts);\n  }\n\n  // Rebuild into camelCase\n  return words\n    .map((word, i) =>\n      i === 0\n        ? word.toLowerCase()\n        : word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()\n    )\n    .join(\"\");\n}\n\nexport function toSnakeCase(input: string): string {\n  // Normalize separators to space\n  const normalized = input.replace(/[_\\-\\s]+/g, \" \").trim();\n\n  // Split by space\n  const roughWords = normalized.split(\" \");\n\n  const words: string[] = [];\n\n  for (const segment of roughWords) {\n    // Split segment by camelCase / PascalCase / acronym transitions\n    const parts = segment.match(\n      /([A-Z]+(?=[A-Z][a-z]))|([A-Z]?[a-z]+)|([A-Z]+)|(\\d+)/g\n    );\n    if (parts) words.push(...parts);\n  }\n\n  return words.map((w) => w.toLowerCase()).join(\"_\");\n}\n\nexport function portal(node: HTMLElement, target: HTMLElement = document.body) {\n  target.appendChild(node);\n\n  return {\n    destroy() {\n      if (node.parentNode) {\n        node.parentNode.removeChild(node);\n      }\n    },\n  };\n}\n\nexport function isValidTimeStr(timeStr: string) {\n  if (timeStr.trim() == \"\") return false;\n  if (typeof timeStr !== \"string\") return false;\n\n  const parts = timeStr.trim().split(\":\");\n  if (parts.length !== 2) return false;\n\n  const [hStr, mStr] = parts;\n  if (!/^\\d+$/.test(hStr) || !/^\\d+$/.test(mStr)) return false;\n\n  const hours = Number(hStr);\n  const minutes = Number(mStr);\n\n  return hours >= 0 && hours <= 23 && minutes >= 0 && minutes <= 59;\n}\n\nexport function isValidDate(date: Date) {\n  return date && date instanceof Date && !isNaN(date.getTime());\n}\n\nexport function formatDateForInput(date: Date) {\n  if (!isValidDate(date)) {\n    logger.warn(\"Invalid 'date' in function 'formatDateForInput(date: Date)'\");\n    return;\n  }\n\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, \"0\"); // mesi 0-indexed\n  const day = String(date.getDate()).padStart(2, \"0\");\n  return `${year}-${month}-${day}`;\n}\n\nexport function addMinutesToTime(timeStr: string, minutesToAdd: number) {\n  if (!isValidTimeStr(timeStr)) {\n    logger.error(\n      \"Invalid 'timeStr' at ddMinutesToTime(timeStr: string, minutesToAdd: number).\"\n    );\n    return;\n  }\n  const [hours, minutes] = timeStr.split(\":\").map(Number);\n  const date = new Date();\n  date.setHours(hours, minutes, 0, 0); // set to today, with given time\n\n  date.setMinutes(date.getMinutes() + minutesToAdd); // add minutes\n\n  const newHours = String(date.getHours()).padStart(2, \"0\");\n  const newMinutes = String(date.getMinutes()).padStart(2, \"0\");\n\n  return `${newHours}:${newMinutes}`;\n}\n\nexport function setTimeForDate(date: Date, timeStr: string) {\n  /*if(!isValidDate(date)) {\n\t\tlogger.error(\"Invalid 'date' at setTimeForDate(date: Date, timeStr: string).\")\n\t\treturn;\n\t};*/\n  if (!isValidTimeStr(timeStr)) {\n    logger.error(\n      \"Invalid 'timeStr' at setTimeForDate(date: Date, timeStr: string).\"\n    );\n    return date;\n  }\n  const [hours, minutes] = timeStr.split(\":\").map(Number);\n\n  const newDate = new Date(date); // clone to avoid mutating original\n  newDate.setHours(hours, minutes, 0, 0);\n  newDate.setMinutes(newDate.getMinutes());\n\n  return newDate;\n}\n\nexport function addMinutesToDate(\n  date: Date,\n  minutesToAdd: number,\n  dateTimeStr?: string\n) {\n  if (!isValidDate(date)) {\n    logger.error(\n      \"Invalid 'date' at addMinutesToDate(date: Date, minutesToAdd: number, dateTimeStr?: string).\"\n    );\n    return;\n  }\n\n  let newDate = new Date(date); // clone to avoid mutating original\n\n  if (dateTimeStr && isValidTimeStr(dateTimeStr))\n    newDate = setTimeForDate(newDate, dateTimeStr) as Date;\n\n  newDate.setMinutes(newDate.getMinutes() + minutesToAdd);\n  return newDate;\n}\n\nexport function parseDate(dateStr: string, fallbackToToday?: boolean) {\n  try {\n    if (typeof dateStr !== \"string\") return null;\n\n    // ISO 8601 (safe and recommended)\n    if (/^\\d{4}-\\d{2}-\\d{2}(T\\d{2}:\\d{2}(:\\d{2})?)?/.test(dateStr)) {\n      const isoDate = new Date(dateStr);\n      return isNaN(isoDate.getTime()) ? null : isoDate;\n    }\n\n    // US format MM/DD/YYYY\n    if (/^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/.test(dateStr)) {\n      const [month, day, year] = dateStr.split(\"/\").map(Number);\n      const date = new Date(year, month - 1, day);\n      return isNaN(date.getTime()) ? null : date;\n    }\n\n    // Optional: support DD/MM/YYYY format\n    if (/^\\d{1,2}-\\d{1,2}-\\d{4}$/.test(dateStr)) {\n      const [day, month, year] = dateStr.split(\"-\").map(Number);\n      const date = new Date(year, month - 1, day);\n      return isNaN(date.getTime()) ? null : date;\n    }\n  } catch (error) {\n    logger.devError(error);\n  } finally {\n    if (fallbackToToday) {\n      return new Date();\n    } else {\n      // Fallback attempt (not recommended in general)\n      return new Date(dateStr);\n    }\n  }\n}\n\nexport function dateToTime24h(date: Date) {\n  if (!validate.date(date)) return null;\n\n  const hours = String(date.getHours()).padStart(2, \"0\");\n  const minutes = String(date.getMinutes()).padStart(2, \"0\");\n  return `${hours}:${minutes}`;\n}\n\nexport function dateToTime12h(date: Date) {\n  if (!(date instanceof Date) || isNaN(date.getTime())) return null;\n\n  let hours = date.getHours();\n  const minutes = String(date.getMinutes()).padStart(2, \"0\");\n  const ampm = hours >= 12 ? \"PM\" : \"AM\";\n\n  hours = hours % 12;\n  hours = hours === 0 ? 12 : hours; // 0 => 12\n\n  return `${String(hours).padStart(2, \"0\")}:${minutes} ${ampm}`;\n}\n\nexport function URLGetParam(\n  paramName: string,\n  url: string = window.location.href\n) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.searchParams.get(paramName);\n  } catch (e) {\n    return null; // URL malformato\n  }\n}\n\nexport function isSameMonth(date1: Date, date2: Date): boolean {\n  if (!validate.date(date1) || !validate.date(date2)) {\n    logger.devError(\n      \"One or more dates are invalid at isSameMonth(date1: Date, date2: Date)\"\n    );\n    return false;\n  }\n\n  return (\n    date1.getFullYear() === date2.getFullYear() &&\n    date1.getMonth() === date2.getMonth()\n  );\n}\n\nexport function isSameYear(date1: unknown, date2: unknown): boolean {\n  if (!(date1 instanceof Date) || isNaN(date1.getTime())) return false;\n  if (!(date2 instanceof Date) || isNaN(date2.getTime())) return false;\n  return date1.getFullYear() === date2.getFullYear();\n}\n\nexport function getMidpointDate(date1: Date, date2: Date): Date {\n  if (\n    !(date1 instanceof Date) ||\n    isNaN(date1.getTime()) ||\n    !(date2 instanceof Date) ||\n    isNaN(date2.getTime())\n  ) {\n    throw new Error(\"Invalid date\");\n  }\n\n  const time1 = date1.getTime();\n  const time2 = date2.getTime();\n  const midpoint = (time1 + time2) / 2;\n\n  return new Date(midpoint);\n}\n\nexport function getYearBounds(date?: Date): { start: Date; end: Date } {\n  const d = date instanceof Date && !isNaN(date.getTime()) ? date : new Date();\n\n  const year = d.getFullYear();\n\n  const start = new Date(year, 0, 1, 0, 0, 0, 0); // 1 gennaio alle 00:00\n  const end = new Date(year, 11, 31, 23, 59, 59, 999); // 31 dicembre alle 23:59:59.999\n\n  return { start, end };\n}\n\nexport function callerName(level = 2): string {\n  const err = new Error();\n  const stack = err.stack?.split(\"\\n\");\n  if (stack && stack.length > level) {\n    const match = stack[level].trim().match(/^at\\s+([^\\s(]+)/);\n    return match?.[1] || \"<anonymous>\";\n  }\n  return \"<unknown>\";\n}\n\nexport function arrayGetByKey<T, K extends keyof T>(\n  array: T[],\n  value: T[K],\n  key: K = \"id\" as K\n): T[] {\n  if (!value) return [];\n  if (!key) return [];\n  if (!array) return [];\n  return array.filter((item) => item[key] === value);\n}\n\nexport function checkFileSize(\n  files: FileList | File[],\n  maxSizeMB: number\n): { valid: boolean; message?: string } {\n  const maxSizeBytes = maxSizeMB * 1024 * 1024;\n  let iterable = Array.from(files);\n  for (const file of iterable) {\n    if (file.size > maxSizeBytes) {\n      return {\n        valid: false,\n        message: `Il file \"${file.name}\" supera la dimensione massima di ${maxSizeMB} MB.`,\n      };\n    }\n  }\n\n  return { valid: true };\n}\n\nexport function getMatchScore(text: string, term: string): number {\n  if (text === term) return 100;\n  if (text.startsWith(term)) return 80;\n  if (text.includes(` ${term}`)) return 60;\n  if (text.includes(term)) return 40;\n  return 0;\n}\n\nexport const componentCallbackDispatcher = (callback: Function, data?: any) => {\n  if (callback) callback(data);\n};\n\nexport function objectsDiffer<T extends Record<string, any>>(\n  a: Partial<T>,\n  b: Partial<T>,\n  strict = false\n): boolean {\n  const clean = (obj: any): any => {\n    // Rimuove Proxy, getter, reactive wrapper ecc.\n    try {\n      return structuredClone(obj);\n    } catch {\n      return JSON.parse(JSON.stringify(obj));\n    }\n  };\n\n  const cleanA = clean(a);\n  const cleanB = clean(b);\n\n  return deepCompare(cleanA, cleanB, strict);\n}\n\nfunction deepCompare(a: any, b: any, strict: boolean): boolean {\n  if (a === b) return false;\n\n  if (\n    typeof a !== \"object\" ||\n    a === null ||\n    typeof b !== \"object\" ||\n    b === null\n  ) {\n    return a !== b;\n  }\n\n  const keys = strict\n    ? new Set([...Object.keys(a), ...Object.keys(b)])\n    : new Set([...Object.keys(a)].filter((key) => key in b));\n\n  for (const key of keys) {\n    const valA = a[key];\n    const valB = b[key];\n\n    const bothObjects =\n      typeof valA === \"object\" &&\n      valA !== null &&\n      typeof valB === \"object\" &&\n      valB !== null;\n\n    if (bothObjects) {\n      if (deepCompare(valA, valB, strict)) return true;\n    } else if (valA !== valB) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function removeNullish<T extends object>(obj: T): Partial<T> {\n  return Object.fromEntries(\n    Object.entries(obj).filter(([_, value]) => value != null)\n  ) as Partial<T>;\n}\n\ntype FlattenOptions = {\n  useDotNotation?: boolean;\n};\n\nexport function flattenObject(\n  obj: Record<string, any>,\n  options: FlattenOptions = {}\n): Record<string, any> {\n  return _flattenObject(obj, options, \"\", {}, new Set());\n}\n\nfunction _flattenObject(\n  obj: Record<string, any>,\n  options: FlattenOptions,\n  _parentKey: string,\n  _result: Record<string, any>,\n  _seen: Set<any>\n): Record<string, any> {\n  const { useDotNotation = false } = options;\n\n  if (_seen.has(obj)) {\n    _result[_parentKey || \"[Circular]\"] = \"[Circular]\";\n    return _result;\n  }\n\n  _seen.add(obj);\n\n  for (const [key, value] of Object.entries(obj)) {\n    const isPlainObject =\n      value !== null &&\n      typeof value === \"object\" &&\n      !Array.isArray(value) &&\n      !(value instanceof Date);\n\n    const fullKey = useDotNotation && _parentKey ? `${_parentKey}.${key}` : key;\n\n    if (isPlainObject) {\n      _flattenObject(value, options, fullKey, _result, _seen);\n    } else {\n      if (useDotNotation) {\n        _result[fullKey] = value;\n      } else {\n        _result[key] = value;\n      }\n    }\n  }\n\n  _seen.delete(obj);\n  return _result;\n}\n\n/**\n * @param normalizeMonthly If true and units is months or years, it will normalize the start and end date to the first and last day of the first and last month.\n */\nexport function getTimeBounds(\n  midpoint: Date | string,\n  before: number,\n  after: number,\n  unit: \"minutes\" | \"days\" | \"months\" | \"years\",\n  normalizeMonthly?: boolean\n): { start: Date; end: Date } {\n  const center = new Date(midpoint);\n  const start = new Date(center);\n  const end = new Date(center);\n\n  switch (unit) {\n    case \"minutes\":\n      start.setMinutes(start.getMinutes() - before);\n      end.setMinutes(end.getMinutes() + after);\n      break;\n\n    case \"days\":\n      start.setDate(start.getDate() - before);\n      end.setDate(end.getDate() + after);\n      start.setHours(0, 0, 0, 0);\n      end.setHours(23, 59, 59, 999);\n      break;\n\n    case \"months\":\n      if (normalizeMonthly) start.setDate(1); // sicurezza (primo del mese)\n      start.setMonth(start.getMonth() - before);\n      end.setMonth(end.getMonth() + after);\n      if (normalizeMonthly) {\n        start.setDate(1);\n        end.setMonth(end.getMonth() + 1, 0); // ultimo giorno del mese\n      }\n      start.setHours(0, 0, 0, 0);\n      end.setHours(23, 59, 59, 999);\n      break;\n\n    case \"years\":\n      if (normalizeMonthly) start.setMonth(0, 1); // sicurezza (1 gennaio)\n      start.setFullYear(start.getFullYear() - before);\n      end.setFullYear(end.getFullYear() + after);\n      if (normalizeMonthly) {\n        start.setMonth(0, 1); // 1 gennaio\n        end.setMonth(12, 0); // 31 dicembre\n      }\n      start.setHours(0, 0, 0, 0);\n      end.setHours(23, 59, 59, 999);\n      break;\n\n    default:\n      throw new Error(`Unsupported unit: ${unit}`);\n  }\n\n  return { start, end };\n}\n\nexport function listMonthsInRange(\n  start: Date | string,\n  end: Date | string,\n  format: \"YYYY-MM\" | \"YYYY-MMM\" | \"YYYY-MMMM\" = \"YYYY-MM\",\n  options?: {\n    locale?: string;\n    excludeStart?: boolean;\n    excludeEnd?: boolean;\n    descending?: boolean;\n  }\n): string[] {\n  const {\n    locale = \"en-US\",\n    excludeStart = false,\n    excludeEnd = false,\n    descending = false,\n  } = options || {};\n\n  let startDate = new Date(start);\n  let endDate = new Date(end);\n\n  if (isNaN(startDate.getTime()) || isNaN(endDate.getTime())) {\n    throw new Error(\"Invalid start or end date\");\n  }\n\n  // Normalizza inizio e fine al primo giorno del mese\n  startDate = new Date(startDate.getFullYear(), startDate.getMonth(), 1);\n  endDate = new Date(endDate.getFullYear(), endDate.getMonth(), 1);\n\n  const months: string[] = [];\n  let current = new Date(startDate);\n\n  while (current <= endDate) {\n    const isStart = current.getTime() === startDate.getTime();\n    const isEnd = current.getTime() === endDate.getTime();\n\n    if ((excludeStart && isStart) || (excludeEnd && isEnd)) {\n      // salta questo mese\n    } else {\n      const year = current.getFullYear();\n      const month = current.getMonth();\n\n      let formatted: string;\n      switch (format) {\n        case \"YYYY-MM\":\n          formatted = `${year}-${String(month + 1).padStart(2, \"0\")}`;\n          break;\n        case \"YYYY-MMM\":\n          formatted = `${year}-${current.toLocaleString(locale, {\n            month: \"short\",\n          })}`;\n          break;\n        case \"YYYY-MMMM\":\n          formatted = `${year}-${current.toLocaleString(locale, {\n            month: \"long\",\n          })}`;\n          break;\n        default:\n          throw new Error(`Unsupported format: ${format}`);\n      }\n\n      months.push(formatted);\n    }\n\n    current.setMonth(current.getMonth() + 1);\n  }\n\n  return descending ? months.reverse() : months;\n}\n\n/**\n * @param monthKey (deve essere in formato YYYY-MM)\n * @returns Restituisce un oggetto contente start e end\n */\nexport function getMonthBoundsByYearMonthString(monthKey: string): {\n  start: Date;\n  end: Date;\n} {\n  const [year, month] = monthKey.split(\"-\").map(Number); // es. 2025, 6\n\n  const start = new Date(Date.UTC(year, month, 1, 0, 0, 0, 0)); // primo giorno del mese\n  const end = new Date(Date.UTC(year, month + 1, 0, 23, 59, 59, 999)); // ultimo giorno del mese\n\n  return { start, end };\n}\n\n/**\n * @returns The month of the passed date as string in the format YYYY-MM (eg. 2025-05), in UTC\n */\nexport function getYearMonthStringFromDate(date: Date): string {\n  const year = date.getUTCFullYear();\n  const month = (date.getUTCMonth() + 1).toString().padStart(2, \"0\");\n  return `${year}-${month}`;\n}\n\n/**\n * @returns Restituisce un oggetto contente start e end\n */\nexport function getMonthBounds(date: Date): { start: Date; end: Date } {\n  const year = date.getUTCFullYear();\n  const month = date.getUTCMonth(); // 0-based\n\n  const start = new Date(Date.UTC(year, month, 1, 0, 0, 0, 0)); // primo giorno del mese\n  const end = new Date(Date.UTC(year, month + 1, 0, 23, 59, 59, 999)); // ultimo giorno del mese\n\n  return { start, end };\n}\n\n/**\n * Unisce l'array originale con nuovi oggetti, sovrascrivendo quelli con la stessa chiave.\n * @param original Array originale\n * @param updates Nuovi oggetti da aggiungere o aggiornare\n * @param key Chiave identificativa (default: \"id\")\n * @returns Nuovo array aggiornato\n */\nexport function mergeByKey<T extends AnyObject>(\n  original: T[],\n  updates: T[],\n  key: keyof T = \"id\"\n): T[] {\n  const map = new Map<any, T>();\n\n  for (const item of original) {\n    map.set(item[key], item);\n  }\n\n  for (const item of updates) {\n    map.set(item[key], item);\n  }\n\n  return Array.from(map.values());\n}\n\n/**\n * Rimuove un elemento da un array di oggetti confrontando un campo chiave.\n *\n * @param array - L'array di oggetti da cui rimuovere l'elemento\n * @param value - Il valore da confrontare per la rimozione\n * @param key - Il campo su cui fare il confronto (default: \"id\")\n * @returns Un nuovo array senza l'elemento corrispondente\n */\nexport function removeFromArrayByKey<T extends Record<string, any>>(\n  array: T[],\n  value: any,\n  key: string = \"id\"\n): T[] {\n  if (!validate.array(array)) throw new Error(\"Invalid array\");\n  return array.filter((item) => item[key] !== value);\n}\n\nexport function hexToRgb(hexString?: HexColor): string | \"\" {\n  const hex = hexString || \"#000000\";\n  const cleaned = hex.replace(/^#/, \"\");\n\n  if (![3, 6].includes(cleaned.length)) return \"(0,0,0)\";\n\n  const fullHex =\n    cleaned.length === 3\n      ? cleaned\n          .split(\"\")\n          .map((c) => c + c)\n          .join(\"\")\n      : cleaned;\n\n  const num = parseInt(fullHex, 16);\n\n  return `(${(num >> 16) & 255 || 0},${(num >> 8) & 255 || 0},${\n    num & 255 || 0\n  })`;\n}\n\nexport async function copyToClipboard(\n  text: string,\n  callback?: Function\n): Promise<void> {\n  try {\n    await navigator.clipboard.writeText(text);\n    logger.log(\"Text copied to clipboard\");\n    if (callback) callback();\n  } catch (err) {\n    logger.error(\"Failed to copy text: \", err);\n  }\n}\n\n/**\n * Reloads the page with the given query parameters if they are not already present or different.\n * Prevents infinite loops by comparing current parameters with target ones.\n * Optionally appends a hash anchor (e.g., #section) for native browser scrolling.\n *\n * @param newParams An object containing key-value pairs to be added to the URL.\n * @param anchor Optional ID of the element to scroll to after reload (e.g. 'comments')\n */\nexport function URLReload(newParams?: Record<string, string>, anchor?: string) {\n  const current = new URLSearchParams(window.location.search);\n  let changed = false;\n\n  if (!validate.object(newParams)) {\n    const hash = anchor ? `#${anchor}` : \"\";\n    location.replace(\n      `${window.location.pathname}${window.location.search}${hash}`\n    );\n    return location.reload();\n  }\n\n  for (const [key, value] of Object.entries(newParams)) {\n    if (current.get(key) !== value) {\n      current.set(key, value);\n      changed = true;\n    }\n  }\n\n  const hash = anchor ? `#${anchor}` : \"\";\n  const query = current.toString();\n  const newUrl = `${window.location.pathname}?${query}${hash}`;\n\n  window.location.replace(newUrl);\n  return location.reload();\n}\n\nexport function flagEmojiToCountryCode(flag: string): string {\n  const countryCode = [...flag]\n    .map((char) => String.fromCharCode(char.codePointAt(0)! - 0x1f1e6 + 0x61))\n    .join(\"\");\n\n  return countryCode.trim().toLowerCase();\n}\n\nexport const wait = (\n  timeout: number = 100,\n  callback?: VoidFunction\n): Promise<void> => {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      callback?.();\n      resolve();\n    }, timeout);\n  });\n};\n\nexport const dropdownOptionsFromStrings = (\n  strings: string[]\n): DropdownOption[] => {\n  const options: DropdownOption[] = [];\n  const optionsIds: string[] = [];\n  for (const str of strings) {\n    if (!str.trim() || !validate.nonEmptyString(str)) continue;\n    const sluggifiedStr: string = str\n      .trim()\n      ?.replaceAll(\" \", \"_\")\n      .toLowerCase();\n    if (optionsIds?.includes(sluggifiedStr)) continue;\n    optionsIds.push(sluggifiedStr);\n    const option: DropdownOption = {\n      label: str,\n      value: sluggifiedStr,\n      id: sluggifiedStr,\n    };\n    options.push(option);\n  }\n\n  return options || [];\n};\n\n\n\n/** Redact likely-sensitive data and normalize message */\nexport function sanitizeMessageSensitiveData(msg: string, maxLen = 300): string {\n  let s = typeof msg === \"string\" ? msg : String(msg);\n\n  // Normalize whitespace (flattens multi-line content)\n  s = s.replace(RE_WS, \" \").trim();\n\n  // Redactions\n  s = s.replace(RE_EMAIL, \"[EMAIL]\");\n  s = s.replace(RE_QUERY_SENSITIVE, (_m, sep, k) => `${sep}${k}=[REDACTED]`);\n  s = s.replace(RE_AUTH, (_m, k) => `${k} [REDACTED]`);\n  s = s.replace(RE_AWS_ACCESS_KEY, \"[AWS_ACCESS_KEY]\");\n  s = s.replace(RE_SECRET40, \"[SECRET_40]\");\n  s = s.replace(RE_JWT, \"[JWT]\");\n  s = s.replace(RE_LONG_DIGITS, \"[NUMBER]\");\n  s = s.replace(RE_PEM_BLOCK, \"[PEM]\");\n  // IPv4 without lookbehind: keep the prefix char (group 1) intact\n  s = s.replace(RE_IPV4_NOLB, (_m, pre) => `${pre}[IP]`);\n  // Secrets in URL path segments\n  s = s.replace(RE_PATH_SECRET, (m) => {\n    const i = m.lastIndexOf(\"/\");\n    return m.slice(0, i + 1) + \"[REDACTED]\";\n  });\n\n  // Truncate\n  if (s.length > maxLen) s = s.slice(0, maxLen) + \"… (truncated)\";\n\n  return s;\n}\n// Typescript: extract only message and optional code, never stack\ntype ErrorInfo = { message: string; code?: string | number };\n\n/**\n * \n * @param err The error to extract message and code from\n * @param sanitize Wether to sanitize the error message, removing potential sensitive data\n * @returns Error info in the format of { message, code}\n */\nexport function getErrorInfo(err: unknown, sanitize:boolean=true): ErrorInfo {\n  let message: string | undefined;\n  let code: string | number | undefined;\n\n  const pull = (e: any, depth = 0) => {\n    if (!e || depth > 3) return;\n\n    // Message from common spots (never use String(e) here)\n    if (!message && typeof e.message === \"string\") message = e.message;\n\n    // Common code fields across runtimes/libs\n    if (code == null) {\n      code =\n        e.code ??\n        e.status ??\n        e.statusCode ??\n        e.errorCode ??\n        e.response?.status ??\n        e.body?.status;\n    }\n\n    // HTTP/API payload shapes\n    if (!message) {\n      const m =\n        e.response?.data?.message ??\n        e.response?.data?.error?.message ??\n        e.data?.message ??\n        e.error?.message ??\n        e.body?.message;\n      if (typeof m === \"string\") message = m;\n    }\n\n    // Aggregate/cause chains\n    if (!message && Array.isArray(e.errors) && e.errors.length) pull(e.errors[0], depth + 1);\n    if (!message && e.cause) pull(e.cause, depth + 1);\n  };\n\n  if (err instanceof Error || (typeof err === \"object\" && err !== null)) {\n    pull(err as any);\n  } else if (typeof err === \"string\") {\n    // Only case where we accept String(err): it's already a string.\n    message = err;\n  }\n\n  // Final fallback: never fabricate by stringifying (could include stack).\n  if (!message) message = \"Unknown error\";\n\n  let finalMessage: string = \"\";\n\n  if(sanitize) finalMessage = sanitizeMessageSensitiveData(message);\n  else finalMessage = message;\n\n  return code != null ? { message: finalMessage, code } : { message: finalMessage };\n}\n","/**\n * Descrive tutte le informazioni rilevanti sulla pagina corrente,\n * ispirato allo store `$page` di SvelteKit ma in ambiente JavaScript puro.\n */\nexport interface PageInfo {\n\turl: URL;\n\tprotocol: string;               // es: 'https:'\n\thost: string;                   // es: 'example.com:3000'\n\thostname: string;               // es: 'example.com'\n\tport: string;                   // es: '3000' (vuoto se default)\n\torigin: string;                 // es: 'https://example.com:3000'\n\tpathname: string;              // es: '/docs/page'\n\tfullPath: string;              // pathname + search + hash\n\tquery: Record<string, string>; // search params in oggetto\n\tsearch: string;                // es: '?id=123&lang=en'\n\thash: string;                  // es: '#section'\n\tparams: Record<string, string>; // dinamici (vuoto se non gestiti)\n\treferrer: string;              // document.referrer\n\tuserAgent: string;             // navigator.userAgent\n\ttimestamp: number;             // ms\n}\n\ntype PageStoreCallback = (page: PageInfo) => void;\n\n/**\n * Crea uno store reattivo che fornisce informazioni aggiornate sulla pagina corrente.\n * Si comporta in modo simile allo store `$page` di SvelteKit ma in ambiente JS puro.\n * Reagisce a popstate, hashchange, pushState e replaceState.\n *\n * @returns Un oggetto con due metodi:\n *  - `subscribe(callback)`: riceve aggiornamenti quando cambia l’URL\n *  - `get()`: restituisce lo stato corrente della pagina\n *  - Utilizza come 'const page=pageStore()' e poi 'page.get()' o 'page.subscribe((info)=>{})'\n */\nexport function pageStore() {\n\tlet listeners: PageStoreCallback[] = [];\n\n\tfunction getPage(): PageInfo {\n\t\tconst url = new URL(window.location.href);\n\n\t\treturn {\n\t\t\turl,\n\t\t\tprotocol: url.protocol,\n\t\t\thost: url.host,\n\t\t\thostname: url.hostname,\n\t\t\tport: url.port,\n\t\t\torigin: url.origin,\n\t\t\tpathname: url.pathname,\n\t\t\tfullPath: url.pathname + url.search + url.hash,\n\t\t\tquery: Object.fromEntries(url.searchParams.entries()),\n\t\t\tsearch: url.search,\n\t\t\thash: url.hash,\n\t\t\tparams: {}, // da riempire se implementi parsing tipo /user/:id\n\t\t\treferrer: document.referrer,\n\t\t\tuserAgent: navigator.userAgent,\n\t\t\ttimestamp: Date.now()\n\t\t};\n\t}\n\n\tfunction notify() {\n\t\tconst page = getPage();\n\t\tfor (const cb of listeners) cb(page);\n\t}\n\n\twindow.addEventListener('popstate', notify);\n\twindow.addEventListener('hashchange', notify);\n\n\t// intercetta push/replaceState\n\tfor (const method of ['pushState', 'replaceState'] as const) {\n\t\tconst original = history[method];\n\t\thistory[method] = function (...args) {\n\t\t\toriginal.apply(this, args);\n\t\t\tnotify();\n\t\t};\n\t}\n\n\treturn {\n\t\tsubscribe(callback: PageStoreCallback) {\n\t\t\tlisteners.push(callback);\n\t\t\tcallback(getPage());\n\t\t\treturn () => {\n\t\t\t\tlisteners = listeners.filter((cb) => cb !== callback);\n\t\t\t};\n\t\t},\n\t\tget: getPage\n\t};\n}\n","// _logger.ts\n\nimport { pageStore } from \"./_pageStore\";\nimport { callerName, isDev } from \"./_utils\";\n\ntype LogFn = (...args: any[]) => void;\n\nconst dev = isDev();\n\nconst noop: LogFn = () => {};\n\nexport const logger = {\n    log: dev ? console.log.bind(console) : noop,\n    warn: dev ? console.warn.bind(console) : noop,\n    error: console.error.bind(console), // always logs\n    devError: dev ? console.error.bind(console) : noop,\n    logCaller: dev\n      ? (...args: any[]) => {\n          const name = callerName(3); // called at log time (3 means level 3, it looks for the caller of the caller, otherwise would always log logger.logCaller)\n          console.log(`${name}()`, ...args);\n        }\n      : noop,\n    page: dev \n      ? () => {\n          console.log(\"Page:\",pageStore().get());\n        }\n      : noop,\n    prod: {\n      log: console.log.bind(console),\n      warn: console.warn.bind(console),\n      logCaller: (...args: any[]) => {\n            const name = callerName(3); // called at log time (3 means level 3, it looks for the caller of the caller, otherwise would always log logger.logCaller)\n            console.log(`${name}()`, ...args);\n          },\n      page: () => {\n            console.log(\"Page:\",pageStore().get());\n          }\n    }\n  };\n","import {logger} from \"./\";\n\nexport type BrowserStorageType = \"local\" | \"session\";\n\ninterface _StoredValue {\n  value: unknown;\n  expiresAt?: number;\n}\n\ninterface _BrowserStorageAPI {\n  getItem(key: string): unknown | null;\n  getNamespaceItems(): { key: string; value: unknown }[];\n  getItemsByKeys(keys: string[]): { key: string; value: unknown }[];\n  setItem(key: string, value: unknown, options?: { expiresIn?: number }): void;\n  removeItem(key: string): void;\n  clear(): void;\n  clearExpired(): void;\n  length(): number;\n  keysList(): string[];\n}\n\nconst _isBrowser = typeof window !== \"undefined\" && typeof document !== \"undefined\";\n\nexport function browserStorage(\n  type: BrowserStorageType,\n  namespace?: string\n): _BrowserStorageAPI {\n  const _storage = _isBrowser\n    ? type === \"local\"\n      ? localStorage\n      : sessionStorage\n    : undefined;\n\n  const _prefix = namespace ? `${namespace}:` : \"\";\n\n  function _fullKey(key: string): string {\n    return `${_prefix}${key}`;\n  }\n\n  function getItem(key: string): unknown | null {\n    if (!_isBrowser) return null;\n\n    const raw = _storage?.getItem(_fullKey(key));\n    if (!raw) return null;\n\n    try {\n      const parsed: _StoredValue = JSON.parse(raw);\n      if (parsed.expiresAt && Date.now() > parsed.expiresAt) {\n        _storage?.removeItem(_fullKey(key));\n        return null;\n      }\n      return parsed.value;\n    } catch {\n      return null;\n    }\n  }\n\nfunction getNamespaceItems(): { key: string; value: unknown }[] {\n  if (!_isBrowser) return [];\n\n  const items: { key: string; value: unknown }[] = [];\n\n  for (let i = 0; i < (_storage?.length ?? 0); i++) {\n    const fullKey = _storage?.key(i);\n    if (!fullKey || (_prefix && !fullKey.startsWith(_prefix))) continue;\n\n    const key = fullKey.slice(_prefix.length); // rimuove il namespace\n    const raw = _storage?.getItem(fullKey);\n    if (!raw) continue;\n\n    try {\n      const parsed: _StoredValue = JSON.parse(raw);\n      if (parsed.expiresAt && Date.now() > parsed.expiresAt) continue;\n\n      items.push({ key, value: parsed.value });\n    } catch {\n      // ignora valori corrotti\n    }\n  }\n\n  return items;\n}\n\nfunction getItemsByKeys(keys: string[]): { key: string; value: unknown }[] {\n  if (!_isBrowser) return [];\n\n  const items: { key: string; value: unknown }[] = [];\n\n  for (const key of keys) {\n    const fullKey = _fullKey(key);\n    const raw = _storage?.getItem(fullKey);\n    if (!raw) continue;\n\n    try {\n      const parsed: _StoredValue = JSON.parse(raw);\n      if (parsed.expiresAt && Date.now() > parsed.expiresAt) continue;\n\n      items.push({ key, value: parsed.value });\n    } catch {\n      // ignora valori corrotti\n    }\n  }\n\n  return items;\n}\n\n\n  function setItem(\n    key: string,\n    value: unknown,\n    options?: { expiresIn?: number }\n  ): void {\n    if (!_isBrowser) return;\n\n    const expiresAt = options?.expiresIn\n      ? Date.now() + options.expiresIn * 1000\n      : undefined;\n\n    const payload: _StoredValue = { value, expiresAt };\n\n    try {\n      _storage?.setItem(_fullKey(key), JSON.stringify(payload));\n    } catch (err) {\n      logger.warn(`[browserStorage] Failed to set key \"${key}\"`, err);\n    }\n  }\n\n  function removeItem(key: string): void {\n    if (!_isBrowser) return;\n    _storage?.removeItem(_fullKey(key));\n  }\n\n  function clear(): void {\n    if (!_isBrowser) return;\n    keysList().forEach((key) => _storage?.removeItem(key));\n  }\n\n  function clearExpired(): void {\n    if (!_isBrowser) return;\n    keysList().forEach((key) => {\n      const raw = _storage?.getItem(key);\n      if (!raw) return;\n      try {\n        const parsed: _StoredValue = JSON.parse(raw);\n        if (parsed.expiresAt && Date.now() > parsed.expiresAt) {\n          _storage?.removeItem(key);\n        }\n      } catch {\n        // ignore\n      }\n    });\n  }\n\n  function length(): number {\n    if (!_isBrowser) return 0;\n    return keysList().length;\n  }\n\n  function keysList(): string[] {\n    if (!_isBrowser) return [];\n    const keys: string[] = [];\n    for (let i = 0; i < (_storage?.length ?? 0); i++) {\n      const key = _storage?.key(i);\n      if (key && (!_prefix || key.startsWith(_prefix))) {\n        keys.push(key);\n      }\n    }\n    return keys;\n  }\n\n  return {\n    getItem,\n    getNamespaceItems,\n    getItemsByKeys,\n    setItem,\n    removeItem,\n    clear,\n    clearExpired,\n    length,\n    keysList,\n  };\n}\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n","import {\n    openDB,\n    type IDBPDatabase,\n    type IndexNames,\n    type StoreKey,\n    type StoreNames,\n    type StoreValue\n} from 'idb';\nimport { logger } from './_logger';\n\nexport interface IDBApi<T> {\n    get(): Promise<IDBPDatabase<T>>;\n    state(storeName: StoreNames<T>): Promise<'not-found' | 'empty' | 'populated'>;\n    delete(storeName: StoreNames<T>, keys: StoreKey<T, StoreNames<T>>[]): Promise<void>;\n    exists(storeName: StoreNames<T>): Promise<boolean>;\n    isPopulated(storeName: StoreNames<T>): Promise<boolean>;\n    put(storeName: StoreNames<T>, doc: StoreValue<T, StoreNames<T>>): Promise<void>;\n    bulkPut(storeName: StoreNames<T>, docs: StoreValue<T, StoreNames<T>>[]): Promise<void>;\n    findByField(storeName: StoreNames<T>, field: IndexNames<T, StoreNames<T>>, value: any): Promise<StoreValue<T, StoreNames<T>>[]>;\n    getAllKeys(storeName: StoreNames<T>): Promise<StoreKey<T, StoreNames<T>>[]>;\n    notifyChange(payload: any): void;\n    onChange(callback: (payload: any) => void): void;\n    deleteDb(): Promise<void>;\n    clearStore(storeName: StoreNames<T>): Promise<void>;\n    paginate(storeName: StoreNames<T>, limit: number, offset: number): Promise<T[]>;\n}\n\ntype StoreSchema = {\n    keyPath?: string;\n    indices?: {\n        name: string;\n        keyPath: string | string[];\n        options?: IDBIndexParameters;\n    }[];\n};\n\ntype StoreDefinition = Record<string, StoreSchema>;\n\nexport async function idb<T = unknown>(\n    dbName: string,\n    version?: number,\n    storeDefs?: StoreDefinition\n): Promise<IDBApi<T>|null> {\n    if (typeof window === 'undefined' || typeof indexedDB === 'undefined') {\n            console.error('[IDB] IndexedDB is not available in this context.');\n            return null;\n        }\n\n    const DB_INSTANCE = await openDB<T>(dbName, version, {\n        upgrade(db) {\n            if (!storeDefs) return;\n\n            for (const [storeName, schema] of Object.entries(storeDefs) as [StoreNames<T>, StoreSchema][]) {\n                if (!db.objectStoreNames.contains(storeName)) {\n                    const store = db.createObjectStore(storeName, {\n                        keyPath: schema.keyPath ?? 'id'\n                    });\n\n                    if (schema.indices) {\n                        for (const index of schema.indices) {\n                            store.createIndex(index.name as IndexNames<T, StoreNames<T>>, index.keyPath, index.options);\n                        }\n                    }\n                }\n            }\n        }\n    });\n\n    async function _get(): Promise<IDBPDatabase<T>> {\n        return DB_INSTANCE;\n    }\n\n    async function _state(storeName: StoreNames<T>): Promise<'not-found' | 'empty' | 'populated'> {\n        try {\n            const db = await _get();\n\n            if (!db.objectStoreNames.contains(storeName)) {\n                return 'not-found';\n            }\n\n            const tx = db.transaction(storeName, 'readonly');\n            const store = tx.objectStore(storeName);\n            const count = await store.count();\n\n            return count === 0 ? 'empty' : 'populated';\n        } catch (err) {\n            logger.error('Error on DB check:', err);\n            return 'not-found';\n        }\n    }\n\n    async function _exists(storeName: StoreNames<T>): Promise<boolean> {\n        const res = await _state(storeName);\n        return !(res === 'not-found');\n    }\n\n    async function _isPopulated(storeName: StoreNames<T>): Promise<boolean> {\n        const res = await _state(storeName);\n        return res === 'populated';\n    }\n\n    async function _clearStore(storeName: StoreNames<T>) {\n        const db = await _get();\n        const tx = db.transaction(storeName, 'readwrite');\n        const store = tx.objectStore(storeName);\n        await store.clear();\n        await tx.done;\n        _notifyChange({ type: 'clearStore', store: storeName });\n    }\n\n    function _deleteDb(): Promise<void> {\n        return new Promise((resolve, reject) => {\n            const request = indexedDB.deleteDatabase(dbName);\n            request.onsuccess = () => resolve();\n            request.onerror = () => reject(request.error);\n            request.onblocked = () => console.warn('Delete blocked: close all tabs.');\n        });\n    }\n\n    async function _getAllKeys(storeName: StoreNames<T>): Promise<StoreKey<T, StoreNames<T>>[]> {\n        const db = await _get();\n        const tx = db.transaction(storeName, 'readonly');\n        const store = tx.objectStore(storeName);\n        return await store.getAllKeys();\n    }\n\n    async function _findByField(\n        storeName: StoreNames<T>,\n        field: IndexNames<T, StoreNames<T>>,\n        value: any\n    ): Promise<StoreValue<T, StoreNames<T>>[]> {\n        const db = await _get();\n        const tx = db.transaction(storeName, 'readonly');\n        const store = tx.objectStore(storeName);\n\n        if (!store.indexNames.contains(field)) {\n            throw new Error(`Index \"${String(field)}\" does not exist`);\n        }\n\n        const index = store.index(field);\n        return await index.getAll(value);\n    }\n\n\n\n    async function _delete(storeName: StoreNames<T>, keys: StoreKey<T, StoreNames<T>>[]) {\n        const db = await _get();\n        const tx = db.transaction(storeName, 'readwrite');\n        const store = tx.objectStore(storeName);\n        for (const key of keys) {\n            await store.delete(key);\n        }\n        await tx.done;\n        _notifyChange({ type: 'delete', store: storeName, keys });\n    }\n\n    async function _put(storeName: StoreNames<T>, doc: StoreValue<T, StoreNames<T>>) {\n        const db = await _get();\n        const tx = db.transaction(storeName, 'readwrite');\n        const store = tx.objectStore(storeName);\n        await store.put(doc);\n        await tx.done;\n        _notifyChange({ type: 'put', store: storeName, doc });\n    }\n\n    async function _bulkPut(storeName: StoreNames<T>, docs: StoreValue<T, StoreNames<T>>[]) {\n        const db = await _get();\n        const tx = db.transaction(storeName, 'readwrite');\n        const store = tx.objectStore(storeName);\n        for (const doc of docs) {\n            await store.put(doc);\n        }\n        await tx.done;\n        _notifyChange({ type: 'bulkPut', store: storeName, count: docs.length });\n    }\n\n    const channel = new BroadcastChannel('indexeddb-sync');\n\n    function _onChange(callback: (payload: any) => void) {\n        channel.onmessage = (event) => {\n            callback(event.data);\n        };\n    }\n\n    function _notifyChange(payload: any) {\n        channel.postMessage(payload);\n    }\n\n    async function _paginate(storeName: StoreNames<T>, limit: number, offset: number): Promise<T[]> {\n        const db = await _get();\n        const tx = db.transaction(storeName);\n        const store = tx.objectStore(storeName);\n\n        const results: T[] = [];\n        let skipped = 0;\n\n        const cursor = await store.openCursor();\n\n        while (cursor && results.length < limit) {\n            if (skipped < offset) {\n                skipped++;\n                await cursor.continue();\n                continue;\n            }\n\n            results.push(cursor.value as T);\n            await cursor.continue();\n        }\n\n        return results;\n    }\n\n    const endpoints = {\n        get: _get,\n        state: _state,\n        delete: _delete,\n        exists: _exists,\n        isPopulated: _isPopulated,\n        put: _put,\n        bulkPut: _bulkPut,\n        findByField: _findByField,\n        getAllKeys: _getAllKeys,\n        notifyChange: _notifyChange,\n        onChange: _onChange,\n        deleteDb: _deleteDb,\n        clearStore: _clearStore,\n        paginate: _paginate\n    };\n\n    return endpoints;\n}\n","// encryption-utils.ts\n\n// ==============================\n// 🔒 Hash / Digest\n// ==============================\n  \n  async function digestHex(input: string, algorithm: \"SHA-1\" | \"SHA-256\" | \"SHA-512\"): Promise<string> {\n    const data = new TextEncoder().encode(input);\n    const hash = await crypto.subtle.digest(algorithm, data);\n    return Array.from(new Uint8Array(hash))\n      .map(b => b.toString(16).padStart(2, \"0\"))\n      .join(\"\");\n  }\n  \n  // ==============================\n  // 🔐 HMAC (digest con chiave)\n  // ==============================\n  \n  async function hmacSha256Hex(key: string, message: string): Promise<string> {\n    const enc = new TextEncoder();\n    const keyData = enc.encode(key);\n    const msgData = enc.encode(message);\n  \n    const cryptoKey = await crypto.subtle.importKey(\n      \"raw\",\n      keyData,\n      { name: \"HMAC\", hash: { name: \"SHA-256\" } },\n      false,\n      [\"sign\"]\n    );\n  \n    const signature = await crypto.subtle.sign(\"HMAC\", cryptoKey, msgData);\n    return Array.from(new Uint8Array(signature))\n      .map(b => b.toString(16).padStart(2, \"0\"))\n      .join(\"\");\n  }\n  \n  // ==============================\n  // 📦 Base64\n  // ==============================\n  \nfunction encodeBase64(input: string): string {\n  const bytes = new TextEncoder().encode(input);\n  let binary = \"\";\n  const chunkSize = 0x8000; // 32 KB per evitare troppi argomenti a String.fromCharCode\n  for (let i = 0; i < bytes.length; i += chunkSize) {\n    const chunk = bytes.subarray(i, i + chunkSize);\n    binary += String.fromCharCode(...chunk);\n  }\n  return btoa(binary);\n}\n\nfunction decodeBase64(base64: string): string {\n  const binary = atob(base64);\n  const len = binary.length;\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  return new TextDecoder().decode(bytes);\n}\n  \n  // ==============================\n  // 🔐 AES-GCM (reversibile)\n  // ==============================\n  \n  async function generateAesKey(): Promise<CryptoKey> {\n    return crypto.subtle.generateKey(\n      { name: \"AES-GCM\", length: 256 },\n      true,\n      [\"encrypt\", \"decrypt\"]\n    );\n  }\n  \n  function generateRandomInitializationVector(): Uint8Array {\n    return crypto.getRandomValues(new Uint8Array(12)); // 96-bit IV\n  }\n  \n  async function aesGcmEncrypt(\n    plaintext: string,\n    key: CryptoKey,\n    iv: BufferSource\n  ): Promise<Uint8Array> {\n    const encoded = new TextEncoder().encode(plaintext);\n    const ciphertext = await crypto.subtle.encrypt(\n        { name: \"AES-GCM\", iv },\n        key,\n        encoded\n      );      \n    return new Uint8Array(ciphertext);\n  }\n  \n  async function aesGcmDecrypt(\n    ciphertext: BufferSource,\n    key: CryptoKey,\n    iv: BufferSource\n  ): Promise<string> {\n    const decrypted = await crypto.subtle.decrypt(\n      { name: \"AES-GCM\", iv },\n      key,\n      ciphertext\n    );\n    return new TextDecoder().decode(decrypted);\n  }\n  \n  \n\nexport const cryptoTools = {\n    digest: {\n        digestHex,\n        hmacSha256Hex\n    },\n    base64: {\n        encode: encodeBase64,\n        decode: decodeBase64\n    },\n    AES: {\n        encode: aesGcmEncrypt,\n        decode: aesGcmDecrypt,\n        randomInitializationVector: generateRandomInitializationVector\n    }\n}","import { AppConfig } from \"./_types\";\n\nlet _config: AppConfig | null = null;\n\n/**\n * Inizializza la configurazione dell'app.\n * Deve essere chiamata **una sola volta** all'avvio dell'app.\n */\nexport function initAppConfig(config: AppConfig): void {\n\tif (_config) {\n\t\tconsole.error('AppConfig already initialized, returning active configuration');\n\t\treturn;\n\t}\n\t_config = config;\n}\n\n/**\n * Restituisce la configurazione attuale.\n * Lancia un errore se `initAppConfig()` non è stato chiamato prima.\n */\nexport function getAppConfig(): AppConfig {\n\tif (!_config) {\n\t\tthrow new Error('No AppConfig initializtion. Use initAppConfig(config) to initialize it');\n\t}\n\treturn _config;\n}\n","import type { Auth, RecaptchaVerifier as RecaptchaVerifierType } from \"firebase/auth\";\n\n// Global singleton\nlet recaptchaVerifier: RecaptchaVerifierType | null = null;\n\nexport async function getRecaptchaVerifier(auth: Auth): Promise<RecaptchaVerifierType> {\n    if (typeof window === 'undefined') throw new Error(\"reCAPTCHA can only be used in the browser.\");\n    // Remove old instance\n    if (recaptchaVerifier) {\n        recaptchaVerifier.clear();\n        recaptchaVerifier = null;\n    }\n\n    // Dynamically import the constructor (not the type)\n    const { RecaptchaVerifier } = await import(\"firebase/auth\");\n\n    // Init reCaptcha component\n    if (!recaptchaVerifier) {\n        recaptchaVerifier = new RecaptchaVerifier(auth, \"recaptcha-container\", {\n            size: \"invisible\"\n        });\n    }\n\n    if (!recaptchaVerifier) throw new Error(\"Failed to create reCAPTCHA verifier\");\n    return recaptchaVerifier;\n}\n","import {\n  ref,\n  uploadBytes,\n  getDownloadURL,\n  listAll,\n  getBlob,\n  deleteObject,\n  type FirebaseStorage,\n} from \"firebase/storage\";\nimport { StorageMethodsInterface } from \"./_types\";\nimport { logger } from \"../../_logger\";\n\nconst getFilePath = (\n  fileName: string,\n  folderSegments: string[]\n): { folderPath: string; fullPath: string; fileName: string } => {\n  const cleanedFileName: string = fileName\n    .trim()\n    .replaceAll(\" \", \"_\")\n    .replaceAll(\"/\", \"\");\n\n  const cleanedSegments = folderSegments.filter((str) => str.trim() !== \"\");\n  const segmentsString: string = cleanedSegments.join(\"/\").trim();\n\n  const folderPath: string = segmentsString\n    .trim()\n    .replaceAll(\"//\", \"/\")\n    .replaceAll(\" \", \"_\");\n\n  const rawFullPath: string = `${folderPath}/${cleanedFileName}`;\n  const fullPath: string = rawFullPath\n    .trim()\n    .replaceAll(\"//\", \"/\")\n    .replaceAll(\" \", \"_\");\n\n  if (!(typeof fullPath === \"string\" && fullPath.trim().length > 0))\n    throw \"The file path is empty or invalid\";\n\n  return {\n    folderPath,\n    fullPath,\n    fileName: cleanedFileName,\n  };\n};\n\nexport const initStorageMethods = (\n  storage: FirebaseStorage\n): StorageMethodsInterface => ({\n  /**\n   * Carica un file su Firebase Storage in un path dinamico.\n   * @param file - Il file da caricare\n   * @param folderSegments - Array di stringhe che formano il path della cartella dove si trova il file (es. per branding/icons/logo.png dovrai passare ['branding', 'icons'])\n   * @returns URL pubblico al file caricato\n   */\n  uploadFile: async function _uploadFile(\n    file: File,\n    fileName: string,\n    folderSegments: string[]\n  ): Promise<string> {\n    logger.logCaller();\n    if (folderSegments.length === 0) {\n      throw new Error(\"Storage path is required\");\n    }\n\n    const filePath = getFilePath(fileName, folderSegments);\n    const fileRef = ref(storage, filePath?.fullPath);\n\n    const snapshot = await uploadBytes(fileRef, file);\n    const url = await getDownloadURL(snapshot.ref);\n\n    return url;\n  },\n\n  /**\n   * Elimina un file da Firebase Storage.\n   * @param folderSegments - Array di stringhe che formano il path della cartella dove si trova il file (es. per branding/icons/logo.png dovrai passare ['branding', 'icons'])\n   */\n  deleteFile: async function _deleteFile(\n    fileName: string,\n    folderSegments: string[]\n  ): Promise<void> {\n    logger.logCaller();\n    const filePath = getFilePath(fileName, folderSegments);\n    const fileRef = ref(storage, filePath?.fullPath);\n\n    await deleteObject(fileRef);\n  },\n\n  /**\n   * Elenca tutti i file in una cartella.\n   * @param folderSegments - Array di stringhe che formano il path della cartella dove si trova il file (es. per branding/icons/logo.png dovrai passare ['branding', 'icons'])\n   */\n  listFiles: async function _listFiles(\n    folderSegments: string[]\n  ): Promise<string[]> {\n    logger.logCaller();\n    const folderPath = getFilePath(\"\", folderSegments)?.folderPath;\n    const folderRef = ref(storage, folderPath);\n\n    const res = await listAll(folderRef);\n    const urls = await Promise.all(\n      res.items.map((itemRef: any) => getDownloadURL(itemRef))\n    );\n\n    return urls;\n  },\n\n  /**\n   * Scarica un file come Blob.\n   * @param folderSegments - Array di stringhe che formano il path della cartella dove si trova il file (es. per branding/icons/logo.png dovrai passare ['branding', 'icons'])\n   * @returns Un Blob del file\n   */\n  downloadFile: async function _downloadFileAsBlob(\n    fileName: string,\n    folderSegments: string[]\n  ): Promise<Blob> {\n    logger.logCaller();\n    const filePath = getFilePath(fileName, folderSegments);\n    const fileRef = ref(storage, filePath?.fullPath);\n\n    return await getBlob(fileRef);\n  },\n\n  /**\n   * Ottiene l'URL pubblico di un file.\n   * @param folderSegments - Array di stringhe che formano il path della cartella dove si trova il file (es. per branding/icons/logo.png dovrai passare ['branding', 'icons'])\n   */\n  getFileUrl: async function _getPublicDownloadURL(\n    fileName: string,\n    folderSegments: string[]\n  ): Promise<string> {\n    logger.logCaller();\n    const filePath = getFilePath(fileName, folderSegments);\n    const fileRef = ref(storage, filePath?.fullPath);\n\n    return await getDownloadURL(fileRef);\n  },\n});\n","import { logger, redirectOrReload, validate, wait } from \"../../\";\nimport {\n  browserLocalPersistence,\n  browserSessionPersistence,\n  createUserWithEmailAndPassword,\n  EmailAuthProvider,\n  GithubAuthProvider,\n  GoogleAuthProvider,\n  reauthenticateWithCredential,\n  sendPasswordResetEmail,\n  setPersistence,\n  signInWithEmailAndPassword,\n  signInWithPopup,\n  signInWithRedirect,\n  signOut,\n  updateEmail,\n  updatePassword,\n  type Auth,\n  type User,\n} from \"firebase/auth\";\nimport type { FirebaseAuthMethods } from \"./_types\";\n\nconst _getFsUser = (auth: Auth): User => {\n  if (!auth?.currentUser) throw new Error(\"User not found\");\n  return auth.currentUser;\n};\n\nexport const initAuthMethods = (auth: Auth): FirebaseAuthMethods => ({\n  //////////////////// SIGNOUT ////////////////////\n  signout: async function firebaseSignout(options?: {redirectUrl?: string; reload?: boolean}) {\n    try {\n      logger.logCaller();\n      await signOut(auth);\n      try{\n        await wait(400);\n        redirectOrReload(options);\n      } catch(error) {\n        logger.error(error);\n      }\n    } catch (err) {\n      logger.devError(\"Logout failed:\", err);\n    }\n  },\n\n  //////////////////// SIGNUP ////////////////////\n  signup: async function firebaseSignup(\n    email: string,\n    password: string,\n    passwordConfirmation: string,\n    redirectPath?: string\n  ): Promise<void> {\n    try {\n      logger.logCaller();\n      // pre-checks\n      if (password != passwordConfirmation)\n        throw new Error(\"Passwords do not match\");\n      //\n      await setPersistence(auth, browserLocalPersistence);\n      const userCredential = await createUserWithEmailAndPassword(\n        auth,\n        email,\n        password\n      );\n      logger.log(\"User signed up:\", userCredential.user);\n      //await goto(redirectPath||'/');\n    } catch (err: any) {\n      logger.devError(\"Signup error:\", err);\n    }\n  },\n\n  //////////////////// SIGNIN ////////////////////\n  signin: async function firebaseSignin(\n    email: string,\n    password: string,\n    remember: boolean,\n    redirectPath?: string\n  ): Promise<void> {\n    try {\n      logger.logCaller();\n      const persistence = remember\n        ? browserLocalPersistence // persist across sessions\n        : browserSessionPersistence; // expires on tab close\n      await setPersistence(auth, persistence);\n      logger.log(\"✅ persistence set\");\n      const userCredential = await signInWithEmailAndPassword(\n        auth,\n        email,\n        password\n      );\n      logger.log(\"✅ Signed in:\", userCredential.user);\n      // await goto(redirectPath||'/');\n    } catch (err: any) {\n      logger.devError(err);\n    }\n  },\n\n  //////////////////// FORGOT PASSWORD ////////////////////\n  forgotPassword: async function forgotPassword(email: string): Promise<void> {\n    try {\n      await sendPasswordResetEmail(auth, email);\n    } catch (error: any) {\n      // do nothing (I dont want the user to know if the email exists or not)\n      logger.devError(error);\n    }\n  },\n\n  //////////////////// GOOGLE AUTH ////////////////////\n  googleAuth: async function googleAuth(withRedirect?: boolean): Promise<void> {\n    try {\n      logger.logCaller();\n\n      const provider = new GoogleAuthProvider();\n\n      await setPersistence(auth, browserLocalPersistence);\n      logger.log(\"Auth persistence set\");\n\n      if(withRedirect) {\n        console.log(`Starting Google auth [redirect]`);\n        await signInWithRedirect(auth, provider);\n      } else {\n        console.log(`Starting Google auth [popup]`);\n        const result = await signInWithPopup(auth, provider);\n        const user = result?.user;\n      }\n    } catch (error: any) {\n      logger.devError(\"Google auth error:\\n\", error?.message);\n    }\n  },\n\n  //////////////////// GITHUB AUTH ////////////////////\n  githubAuth: async function gitHubAuth(withRedirect?: boolean): Promise<void> {\n    try {\n      logger.logCaller();\n\n      const provider = new GithubAuthProvider();\n\n      await setPersistence(auth, browserLocalPersistence);\n      logger.log(\"Auth persistence set\");\n\n      if(withRedirect) {\n        console.log(`Starting GitHub auth [redirect]`);\n        await signInWithRedirect(auth, provider);\n      } else {\n        console.log(`Starting GitHub auth [popup]`);\n        const result = await signInWithPopup(auth, provider);\n        const user = result?.user;\n      }\n\n    } catch (error: any) {\n      logger.devError(\"GitHub auth error:\\n\", error?.message);\n    }\n  },\n\n  isLoggedIn: (): boolean => {\n    logger.logCaller();\n\n    if (!auth) return false;\n\n    const currentUser: User = auth?.currentUser as User;\n    logger.log(currentUser);\n    if (!currentUser) return false;\n\n    const isAnonymus: boolean = currentUser?.isAnonymous as boolean;\n    logger.log(isAnonymus);\n    if (isAnonymus) return false;\n\n    const uid: string = currentUser?.uid as string;\n    logger.log(uid);\n    if (!validate.nonEmptyString(uid)) return false;\n\n    return true;\n  },\n  // --- Helper: Reauthenticate with email/password ---\n  reauthenticate: async function reauthenticateUser(\n    email: string,\n    currentPassword: string\n  ) {\n    logger.logCaller();\n    const user = auth?.currentUser;\n    if (!user) throw \"User is not authenticated.\";\n    const credential = EmailAuthProvider.credential(email, currentPassword);\n    await reauthenticateWithCredential(user, credential);\n  },\n\n  // --- Update Email ---\n  updateEmail: async function updateUserEmail(newEmail: string) {\n    logger.logCaller();\n    const user = auth?.currentUser;\n    if (!user) throw \"User is not authenticated.\";\n    await updateEmail(user, newEmail);\n  },\n\n  // --- Update Password ---\n  updatePassword: async function updateUserPassword(newPassword: string) {\n    logger.logCaller();\n    const user = auth?.currentUser;\n    if (!user) throw \"User is not authenticated.\";\n    await updatePassword(user, newPassword);\n  },\n\n  // --- Update Password ---\n  get: function get() {\n    logger.logCaller();\n    const user = auth?.currentUser;\n    if (!user) throw \"User is not authenticated.\";\n    return user;\n  },\n});\n\n//////////////////// OBJECT ////////////////////\n// export const _firebaseAuthMethods: FirebaseAuthMethods = {\n// \tsignout: firebaseSignout,\n// \tsignup: firebaseSignup,\n// \tsignin: firebaseSignin,\n// \tforgotPassword,\n// \tgoogleAuth,\n// \tgitHubAuth\n// };\n","import { Auth, onAuthStateChanged, type User } from 'firebase/auth';\nimport { validate } from '../../_typesValidation';\nimport { AuthState } from './_types';\n\nlet observer: AuthState | null | undefined = null;\n\n/**\n * Store reattivo per l’utente Firebase.\n * - subscribe(cb): si registra per ricevere aggiornamenti (via onAuthStateChanged)\n * - user(): restituisce lo stato corrente dell’utente (User | null)\n * - logged(): restituisce true se l'utente è loggato altrimenti false\n * - get(): Returns app auth instance\n */\nexport function authStateObsverver(appAuth: ReturnType<typeof import('firebase/auth').getAuth>): AuthState {\n  if(observer) {\n    console.warn(\"authStateObsverver() already initialized, returning active instance\");\n    return observer;\n  };\n\n  let listeners: Array<(user: User | null) => void> = [];\n  let current: User | null = null;\n\n  function notify(user: User | null) {\n    current = user;\n    for (const cb of listeners) cb(user);\n  }\n\n  // Avvia il listener Firebase una sola volta\n  onAuthStateChanged(appAuth, (user) => {\n    notify(user);\n  });\n\n  const _observer = {\n    /** \n     * callback: (user) => void  \n     * restituisce un unsubscribe \n     */\n    subscribe(callback: (user: User | null) => void) {\n      listeners.push(callback);\n      callback(current);\n      return () => {\n        listeners = listeners.filter((cb) => cb !== callback);\n      };\n    },\n\n    /** sincrono: leggi l’ultimo valore noto */\n    user(): User | null {\n      return current;\n    },\n\n    /** sincrono: leggi l’ultimo valore noto e se risulta loggato restituisci true altrimenti false */\n    logged(): boolean {\n      const uid = current?.uid;\n      return validate.nonEmptyString(uid);\n\t  },\n\n    /** sincrono: leggi l’ultimo valore noto e se risulta loggato restituisci true altrimenti false */\n    get(): Auth {\n\t\t  return appAuth;\n\t  }\n  };\n\n  observer = _observer;\n  return _observer;\n}\n","import {\n  doc,\n  setDoc,\n  updateDoc,\n  Timestamp,\n  getDoc,\n  deleteDoc,\n  collection,\n  DocumentReference,\n  type DocumentData,\n  query,\n  where,\n  getDocs,\n  type WhereFilterOp,\n  serverTimestamp,\n  Firestore,\n  addDoc,\n  Query,\n} from \"firebase/firestore\";\nimport {\n  getRecaptchaVerifier,\n  type AppUser,\n  type Collections,\n  type FirebaseUserPublicData,\n} from \"../\";\nimport { logger } from \"../../\";\nimport { validate } from \"../../\";\nimport {\n  updateEmail,\n  updatePassword,\n  PhoneAuthProvider,\n  EmailAuthProvider,\n  reauthenticateWithCredential,\n  linkWithCredential,\n  type User,\n  updateProfile,\n  type Auth,\n} from \"firebase/auth\";\nimport type { FStore, FStoreDoc, FStoreUser } from \"./_types\";\nimport { cryptoTools } from \"../../_crypto\";\n\nconst _userCollectionRestriction = (collectionName: Collections) => {\n  if (collectionName === \"users\")\n    throw new Error(\"Do NOT use this function for the user doc\");\n};\nconst _getFsUser = (auth: Auth): User => {\n  if (!auth?.currentUser) throw new Error(\"User not found\");\n  return auth.currentUser;\n};\n\nexport async function _getDoc<T>(\n  db: Firestore,\n  collectionName: string,\n  id: string\n): Promise<(T & { id: string }) | null> {\n  logger.logCaller();\n  if (!validate.string(id)) throw new Error(\"Missing document ID.\");\n  const ref = doc(db, collectionName, id);\n  const snap = await getDoc(ref);\n  if (!snap.exists()) return null;\n  return { id: snap.id, ...snap.data() } as T & { id: string };\n}\n\n/** \n * (set doc senza merge, genera l'id prima di crearlo)\n * @returns Restituisce l'id del documento creato\n */\nexport async function create<T>(\n  auth: Auth,\n  db: Firestore,\n  collectionName: Collections,\n  data: T\n): Promise<string> {\n  logger.logCaller();\n  _userCollectionRestriction(collectionName);\n  const date: Date = new Date();\n  const createdAt = Timestamp.fromDate(date);\n  const preRef = doc(collection(db, collectionName)); // genera un nuovo doc ID dentro la collection\n  const raw = `${preRef.id}_${createdAt.toMillis()}`;\n  // Calcola hash SHA256\n  const hash: string = await cryptoTools.digest.digestHex(raw,\"SHA-256\") || \"\";\n\n  await setDoc(preRef, {\n    id: preRef.id,\n    hash,\n    locale: navigator?.language || (await appUserGet(auth, db))?.locale,\n    createdAt,\n    lastModified: createdAt,\n    ...data,\n  });\n  return preRef.id;\n}\n\n/**\n * @returns Restituisce l'id del documento\n */\nexport async function update<T>(\n  db: Firestore,\n  collectionName: Collections,\n  id: string,\n  data: Partial<T>\n): Promise<string> {\n  logger.logCaller();\n  _userCollectionRestriction(collectionName);\n  if (!validate.string(id)) throw new Error(\"Missing document ID.\");\n  const date: Date = new Date();\n  const lastModified = Timestamp.fromDate(date);\n  const preRef = doc(collection(db, collectionName)); // genera un nuovo doc ID dentro la collection\n  const raw = `${id}_${lastModified.toMillis()}`;\n  // Calcola hash SHA256\n  const hash: string = await cryptoTools.digest.digestHex(raw,\"SHA-256\") || \"\";\n  await updateDoc(doc(db, collectionName, id), {\n    ...data,\n    hash,\n    lastModified\n  });\n  return id;\n}\n\n\n/**\n * @returns Restituisce l'id del documento\n */\nexport async function set<T>(\n  db: Firestore,\n  collectionName: Collections,\n  id: string,\n  data: Partial<T>\n): Promise<string> {\n  _userCollectionRestriction(collectionName);\n  if (!validate.string(id)) throw new Error(\"Missing document ID.\");\n  const date: Date = new Date();\n  const lastModified = Timestamp.fromDate(date);\n  const preRef = doc(collection(db, collectionName)); // genera un nuovo doc ID dentro la collection\n  const raw = `${id}_${lastModified.toMillis()}`;\n  // Calcola hash SHA256\n  const hash: string = await cryptoTools.digest.digestHex(raw,\"SHA-256\") || \"\";\n  await setDoc(doc(db, collectionName, id), {\n    ...data,\n    id,\n    hash,\n    lastModified\n  }, {merge: true});\n  return id;\n}\n\n/**\n * @param collectionName Il nome della collection del documento\n * @param id L'id del documento\n * @returns Restituisce i dati del documento se esiste, altrimenti null\n */\nexport async function get<T>(\n  db: Firestore,\n  collectionName: Collections,\n  id: string\n): Promise<(T & { id: string }) | null> {\n  logger.logCaller();\n  _userCollectionRestriction(collectionName);\n  return await _getDoc(db, collectionName, id);\n}\n\nexport async function listDocs<T>(\n  db: Firestore,\n  collectionName: Collections,\n  conditions?: [string, WhereFilterOp, any]\n): Promise<(T & { id: string })[]> {\n  logger.logCaller();\n  let q: Query<DocumentData, DocumentData>;\n\n  if(conditions && conditions?.length>0){\n    q = query(\n      collection(db, collectionName),\n      ...conditions.map(([field, op, value]) => where(field, op, value))\n    );\n  } else {\n    q = collection(db, collectionName);\n  }\n\n  const snapshot = await getDocs(q);\n  return snapshot.docs.map((docSnap) => ({\n    id: docSnap.id,\n    ...docSnap.data()\n  })) as (T & { id: string })[];\n}\n\nexport async function remove(\n  db: Firestore,\n  collection: Collections,\n  id: string\n): Promise<string> {\n  logger.logCaller();\n  if (!validate.string(id)) throw new Error(\"Missing document ID.\");\n  const docRef = doc(db, collection, id);\n  await deleteDoc(docRef);\n  return id;\n}\n\nexport async function removeWhere(\n  db: Firestore,\n  collectionName: Collections,\n  conditions: [string, WhereFilterOp, any][]\n): Promise<string[]> {\n  logger.logCaller();\n  const q = query(\n    collection(db, collectionName),\n    ...conditions.map(([field, op, value]) => where(field, op, value))\n  );\n  const snapshot = await getDocs(q);\n  const deletions = snapshot.docs.map((docSnap) => deleteDoc(docSnap.ref));\n  await Promise.all(deletions);\n  return snapshot.docs.map((docSnap) => docSnap.id);\n}\n\nexport async function createInSubcollection<T>(\n  db: Firestore,\n  parentCollection: Collections,\n  parentId: string,\n  subcollection: string,\n  data: T,\n  isUser?: boolean\n): Promise<string> {\n  logger.logCaller();\n  if (!validate.string(parentId)) throw new Error(\"Missing parent document ID.\");\n  if(!isUser) _userCollectionRestriction(parentCollection);\n  const subRef = collection(db, parentCollection, parentId, subcollection);\n  const preRef = doc(subRef);\n  const createdAt = Timestamp.fromDate(new Date());\n  const raw = `${preRef.id}_${createdAt.toMillis()}`;\n  // Calcola hash SHA256\n  const hash: string = await cryptoTools.digest.digestHex(raw,\"SHA-256\") || \"\";\n  await setDoc(preRef, {\n    ...data,\n    id: preRef.id,\n    hash,\n    createdAt\n  });\n  return preRef.id;\n}\n\nexport async function setInSubcollection<T>(\n  db: Firestore,\n  parentCollection: Collections,\n  parentId: string,\n  subcollection: string,\n  docId: string,\n  data: Partial<T>,\n  isUser?: boolean\n): Promise<string> {\n  logger.logCaller();\n  if (!validate.string(parentId) || !validate.string(docId))\n    throw new Error(\"Missing parent or subdocument ID.\");\n  if(!isUser) _userCollectionRestriction(parentCollection);\n  const ref = doc(db, parentCollection, parentId, subcollection, docId);\n  const lastModified = Timestamp.fromDate(new Date());\n  const raw = `${docId}_${lastModified.toMillis()}`;\n  // Calcola hash SHA256\n  const hash: string = await cryptoTools.digest.digestHex(raw,\"SHA-256\") || \"\";\n  await setDoc(ref, {\n    ...data,\n    id: docId,\n    hash,\n    lastModified\n  }, { merge: true });\n  return docId;\n}\n\nexport async function getFromSubcollection<T>(\n  db: Firestore,\n  parentCollection: Collections,\n  parentId: string,\n  subcollection: string,\n  docId: string,\n  isUser?: boolean\n): Promise<(T & { id: string }) | null> {\n  logger.logCaller();\n  if (!validate.string(parentId) || !validate.string(docId))\n    throw new Error(\"Missing parent or subdocument ID.\");\n  if(!isUser) _userCollectionRestriction(parentCollection);\n  const ref = doc(db, parentCollection, parentId, subcollection, docId);\n  const snap = await getDoc(ref);\n  if (!snap.exists()) return null;\n  return { id: snap.id, ...snap.data() } as T & { id: string };\n}\n\nexport async function listFromSubcollection<T>(\n  db: Firestore,\n  parentCollection: Collections,\n  parentId: string,\n  subcollection: string,\n  isUser?: boolean\n): Promise<(T & { id: string })[]> {\n  logger.logCaller();\n  if (!validate.string(parentId))\n    throw new Error(\"Missing parent document ID.\");\n  if(!isUser) _userCollectionRestriction(parentCollection);\n  const colRef = collection(db, parentCollection, parentId, subcollection);\n  const snapshot = await getDocs(colRef);\n  return snapshot.docs.map((docSnap) => ({\n    id: docSnap.id,\n    ...docSnap.data(),\n  })) as (T & { id: string })[];\n}\n\nexport async function removeFromSubcollection(\n  db: Firestore,\n  parentCollection: Collections,\n  parentId: string,\n  subcollection: string,\n  docId: string,\n  isUser?: boolean\n): Promise<string> {\n  logger.logCaller();\n  if (!validate.string(parentId) || !validate.string(docId))\n    throw new Error(\"Missing parent or subdocument ID.\");\n  if(!isUser) _userCollectionRestriction(parentCollection);\n  const ref = doc(db, parentCollection, parentId, subcollection, docId);\n  await deleteDoc(ref);\n  return docId;\n}\n\n\n\n///////////// users collection functions /////////////\n\nexport async function appUserSet(\n  auth: Auth,\n  db: Firestore,\n  data: Record<string, any> | AppUser,\n  opts: { merge?: boolean; id?: string } = { merge: true }\n) {\n  logger.logCaller();\n  const user = _getFsUser(auth);\n  const { merge, id } = opts;\n  const userId: string = id ?? (user?.uid as string);\n\n  if (!validate.string(userId))\n    throw new Error(\"Could not find User or its uid.\");\n  await setDoc(\n    doc(db, \"users\", userId),\n    {\n      ...data,\n      displayName: data?.displayName ?? user.displayName,\n    },\n    { merge }\n  );\n}\n\nexport async function appUserGet(auth: Auth, db: Firestore): Promise<AppUser> {\n  logger.logCaller();\n  const userId: string = auth.currentUser?.uid as string;\n  if (!validate.string(userId))\n    throw new Error(\"Could not find User or its uid.\");\n  const userData = await _getDoc(db, \"users\", userId);\n  if (!userData) logger.warn(\"⚠️ No user document found.\");\n  return userData as AppUser;\n}\n\nexport async function appUserCreateInSubcollection<T>(\n  db: Firestore,\n  userId: string,\n  subcollection: string,\n  data: T\n): Promise<string> {\n  logger.logCaller();\n  if (!validate.string(userId)) throw new Error(\"Missing user document ID.\");\n  const id = await createInSubcollection(db,\"users\",userId,subcollection, data, true);\n  return id;\n}\n\nexport async function appUserSetInSubcollection<T>(\n  db: Firestore,\n  userId: string,\n  subcollection: string,\n  docId: string,\n  data: Partial<T>\n): Promise<string> {\n  logger.logCaller();\n  if (!validate.string(userId) || !validate.string(docId))\n    throw new Error(\"Missing parent or subdocument ID.\");\n  await setInSubcollection(db,\"users\",userId,subcollection,docId, data, true);\n  return docId;\n}\n\nexport async function appUserGetFromSubcollection<T>(\n  db: Firestore,\n  userId: string,\n  subcollection: string,\n  docId: string\n): Promise<(T & { id: string }) | null> {\n  logger.logCaller();\n  if (!validate.string(userId) || !validate.string(docId))\n    throw new Error(\"Missing parent or subdocument ID.\");\n  const res = await getFromSubcollection(db,\"users\",userId,subcollection,docId, true);\n  return res as (T & { id: string } | null);\n}\n\nexport async function appUserListFromSubcollection<T>(\n  db: Firestore,\n  userId: string,\n  subcollection: string\n): Promise<(T & { id: string })[]> {\n  logger.logCaller();\n  if (!validate.string(userId))\n    throw new Error(\"Missing parent document ID.\");\n    const res = await listFromSubcollection(db,\"users\",userId,subcollection, true);\n    return res as (T & { id: string })[];\n}\n\nexport async function appUserRemoveFromSubcollection(\n  db: Firestore,\n  userId: string,\n  subcollection: string,\n  docId: string\n): Promise<string> {\n  logger.logCaller();\n  if (!validate.string(userId) || !validate.string(docId))\n    throw new Error(\"Missing parent or subdocument ID.\");\n  await removeFromSubcollection(db,\"users\",userId,subcollection,docId, true);\n  return docId;\n}\n\n///////////// firestore user functions /////////////\n\nexport function userGet(auth: Auth): User {\n  logger.logCaller();\n  const user = _getFsUser(auth);\n  return user;\n}\n\nexport async function userProfileSet(auth: Auth, data: FirebaseUserPublicData) {\n  logger.logCaller();\n  const user = _getFsUser(auth);\n  await updateProfile(user, data);\n}\n\n// --- Update Phone Number (requires verification) ---\nexport async function updateUserPhoneNumber(\n  auth: Auth,\n  db: Firestore,\n  phoneNumber: string\n) {\n  logger.logCaller();\n  const user = _getFsUser(auth);\n\n  logger.log(\"Phone number verication initiated\");\n  const provider = new PhoneAuthProvider(auth);\n  const recaptchaVerifier = await getRecaptchaVerifier(auth);\n  logger.log(\"reCapthca verifier retreived\");\n  const verificationId = await provider.verifyPhoneNumber(\n    phoneNumber,\n    recaptchaVerifier\n  );\n  logger.log(\"Verification ID retreived\");\n\n  // Prompt user to enter the verification code sent to their phone\n  logger.log(\"Prompting verification code input\");\n  const verificationCode = window.prompt(\n    \"Inserisci il codice di verifica inviato al tuo numero:\"\n  );\n\n  if (!verificationCode) {\n    const errorMessage = \"Codice di verifica errato o mancante\";\n    logger.error(errorMessage);\n    return;\n  }\n\n  const credential = PhoneAuthProvider.credential(\n    verificationId,\n    verificationCode\n  );\n  await linkWithCredential(user, credential);\n  await appUserSet(auth, db, { phoneNumber });\n}\n\n\nexport const initFirestoreDocsMethods = (\n  auth: Auth,\n  db: Firestore,\n  usersCollectionName: string = \"users\"\n): FStoreDoc => ({\n  create: async function _create(\n    collectionName: Collections,\n    data: unknown\n  ): Promise<string> {\n    return await create(auth, db, collectionName, data);\n  },\n  update: async function _update(\n    collectionName: Collections,\n    id: string,\n    data: Partial<unknown>\n  ): Promise<string> {\n    return await update(db, collectionName, id, data);\n  },\n  set: async function _set(\n    collectionName: Collections,\n    id: string,\n    data: Partial<unknown>\n  ): Promise<string> {\n    return await set(db, collectionName, id, data);\n  },\n  get: async function _get(\n    collectionName: Collections,\n    id: string\n  ): Promise<(string & { id: string }) | null> {\n    return await get(db, collectionName, id);\n  },\n  list: async function _list(collectionName: Collections, conditions?: [string, WhereFilterOp, any]): Promise<any[]>{\n    if(conditions && conditions?.length>0) return await listDocs(db, collectionName, conditions);\n    else return await listDocs(db, collectionName);\n    \n  },\n  remove: async function _remove(\n    collectionName: Collections,\n    id: string\n  ): Promise<string> {\n    return await remove(db, collectionName, id);\n  },\n  removeWhere: async function _removeWhere(\n    collectionName: Collections,\n    conditions: [string, WhereFilterOp, any][]\n  ): Promise<string[]> {\n    return await removeWhere(db, collectionName, conditions);\n  },\n  subcollections: {\n    create: async function _create(parentCollection: Collections, parentId: string, subcollection: string, data: any): Promise<string> {\n      const res = await createInSubcollection(db, parentCollection, parentId, subcollection, data);\n      return res;\n    },\n    set: async function _set(parentCollection: Collections, parentId: string, subcollection: string, docId: string, data: any): Promise<string> {\n      const res = await setInSubcollection(db, parentCollection, parentId, subcollection, docId, data);\n      return res;\n    },\n    get: async function _get(parentCollection: Collections, parentId: string, subcollection: string, docId: string): Promise<{\n      id: string;\n  } | null> {\n      const res = await getFromSubcollection(db, parentCollection, parentId, subcollection, docId);\n      return res;\n    },\n    list: async function _list(parentCollection: Collections, parentId: string, subcollection: string): Promise<{\n      id: string;\n    }[]> {\n      const res = await listFromSubcollection(db, parentCollection, parentId, subcollection,);\n      return res;\n    },\n    remove: async function _remove(parentCollection: Collections, parentId: string, subcollection: string, docId: string): Promise<string> {\n      const res = await removeFromSubcollection(db, parentCollection, parentId, subcollection, docId);\n      return res;\n    }\n  },\n  users: {\n    create: async function _create(\n      data: unknown\n    ): Promise<string> {\n      return await create(auth, db, usersCollectionName, data);\n    },\n    update: async function _update(\n      id: string,\n      data: Partial<unknown>\n    ): Promise<string> {\n      return await update(db, usersCollectionName, id, data);\n    },\n    set: async function _set(\n      id: string,\n      data: Partial<unknown>\n    ): Promise<string> {\n      return await set(db, usersCollectionName, id, data);\n    },\n    get: async function _get(\n      id: string\n    ): Promise<(string & { id: string }) | null> {\n      return await get(db, usersCollectionName, id);\n    },\n    remove: async function _remove(\n      id: string\n    ): Promise<string> {\n      return await remove(db, usersCollectionName, id);\n    },\n    removeWhere: async function _removeWhere(\n      conditions: [string, WhereFilterOp, any][]\n    ): Promise<string[]> {\n      return await removeWhere(db, usersCollectionName, conditions);\n    },\n    subcollections: {\n      create: async function _create(userId: string, subcollection: string, data: any): Promise<string> {\n        const res = await appUserCreateInSubcollection(db, userId, subcollection, data);\n        return res;\n      },\n      set: async function _set(userId: string, subcollection: string, docId: string, data: any): Promise<string> {\n        const res = await appUserSetInSubcollection(db, userId, subcollection, docId, data);\n        return res;\n      },\n      get: async function _get(userId: string, subcollection: string, docId: string): Promise<{\n        id: string;\n    } | null> {\n        const res = await appUserGetFromSubcollection(db, userId, subcollection, docId);\n        return res;\n      },\n      list: async function _list(userId: string, subcollection: string): Promise<{\n        id: string;\n      }[]> {\n        const res = await appUserListFromSubcollection(db, userId, subcollection);\n        return res;\n      },\n      remove: async function _remove(userId: string, subcollection: string, docId: string): Promise<string> {\n        const res = await appUserRemoveFromSubcollection(db, userId, subcollection, docId);\n        return res;\n      }\n    }\n  },\n});\n\nexport const initFirestoreCurrentUserDocMethods = (\n  auth: Auth,\n  db: Firestore\n): FStoreUser => ({\n  set: async function _set(\n    data: Record<string, any> | AppUser,\n    opts?: { merge?: boolean; id?: string }\n  ): Promise<void> {\n    return await appUserSet(auth, db, data, opts);\n  },\n  get: async function _get(): Promise<AppUser> {\n    return await appUserGet(auth, db);\n  },\n});\n\n\n\n/**\n * DISABLED\n *\nexport const initUserDoc = async (auth: Auth, user: User) => {\n  return;\n\tlogger.logCaller();\n\tconst userDoc = await appUserGet(auth);\n\tif(userDoc) return logger.log(\"✔️ User doc already initiated\");\n\tconst timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n\tconst uid: string = user.uid;\n\tawait appUserSet(\n\t\t{\n\t\t\trole: 'standard',\n\t\t\tenabled: true,\n\t\t\tid: uid,\n\t\t\tdisplayName: user.displayName,\n\t\t\tphoneNumber: user.phoneNumber,\n\t\t\temail: user.email,\n\t\t\tcreatedAt: serverTimestamp(),\n\t\t\tlocale: navigator.language,\n\t\t\ttimeZone\n\t\t} as AppUser,\n\t\t{ id: uid }\n\t);\n\tlogger.log('✅ User doc initiated');\n}\n*/\n\n// const firestoreDocs = {create,update,set,get,remove,removeWhere};\n\n// const _fstore: FStore = {\n//   doc: {\n//     ...firestoreDocs\n//   },\n//   user: {\n//     doc: {\n//       set: appUserSet,\n//       get: appUserGet\n//     },\n//     set: {\n//       profile: userProfileSet,\n//       phoneNumber: updateUserPhoneNumber\n//     },\n//     get: userGet,\n//     reauthenticate: reauthenticateUser,\n//     changeEmail: updateUserEmail,\n//     changePassword: updateUserPassword\n//   }\n// }","import {\n  Timestamp,\n  DocumentReference,\n  GeoPoint,\n  FieldValue\n} from 'firebase/firestore';\n\nexport interface FirestoreValidate {\n  timestamp(v: any): v is Timestamp;\n  documentReference(v: any): v is DocumentReference;\n  geoPoint(v: any): v is GeoPoint;\n  fieldValue(v: any): v is FieldValue;\n}\n\nexport const _firestoreValidate: FirestoreValidate = {\n  timestamp: (v): v is Timestamp => v instanceof Timestamp,\n  documentReference: (v): v is DocumentReference =>\n    v && typeof v.path === 'string' && typeof v.id === 'string',\n  geoPoint: (v): v is GeoPoint => v instanceof GeoPoint,\n  fieldValue: (v): v is FieldValue =>\n    typeof v === 'object' && v !== null && typeof (v as any)._methodName === 'string',\n};\n","import type { FirebaseClient, FirebaseServiceIstances } from \"./_types\";\nimport { initStorageMethods } from \"./storage\";\nimport { initAuthMethods } from \"./auth\";\nimport {\n  initFirestoreCurrentUserDocMethods,\n  initFirestoreDocsMethods,\n} from \"./firestore\";\nimport { FirebaseApp, getApp, getApps } from \"firebase/app\";\n\nlet client: FirebaseClient | null | undefined;\n\nexport const initializeFirebaseClient = (\n  services?: FirebaseServiceIstances\n): FirebaseClient => {\n\n  if(client) {\n    console.warn(\"Firebase client already initialized, returning active instance\");\n    return client;\n  }\n\n  const apps: FirebaseApp[] = getApps() || [];\n\n  if (apps?.length && apps?.length === 0) throw \"Couldn't find any Firebase initialization\";\n\n  let _client: FirebaseClient = {\n    instances: {\n      app: getApp(),\n      ...services,\n    },\n  };\n\n  if (services?.storage) _client.storage = initStorageMethods(services.storage); // non dipende da auth (credo)\n\n  const auth = services?.auth;\n  if (auth) _client[\"currentUser\"] = initAuthMethods(auth);\n  else return _client;\n\n  if (services?.firestore) _client[\"currentUser\"][\"doc\"] = initFirestoreCurrentUserDocMethods(auth, services.firestore);\n  if (services?.firestore) _client[\"firestore\"] = initFirestoreDocsMethods(auth, services.firestore);\n\n  client=_client;\n\n  return _client;\n};\n","import {\n  FirebaseApp,\n  getApp,\n  getApps,\n  initializeApp,\n} from \"firebase/app\";\nimport { FirebaseStorage, getStorage } from \"firebase/storage\";\nimport { Auth, getAuth } from \"firebase/auth\";\nimport { Functions, getFunctions, HttpsCallable, httpsCallable, HttpsCallableOptions, HttpsCallableResult } from \"firebase/functions\";\nimport {\n  Firestore,\n  initializeFirestore,\n  persistentLocalCache,\n  persistentMultipleTabManager,\n} from \"firebase/firestore\";\nimport { validate } from \"../_typesValidation\";\nimport { initializeFirebaseClient } from \"./_client\";\nimport { ExtendedFirebaseOptions, FirebaseInitializationContext } from \"./_types\";\nimport { isDev } from \"../_utils\";\n\nlet _context: FirebaseInitializationContext | null | undefined;\n\nlet _functions: Functions | null | undefined;\n\nconst initFunctions = (app: FirebaseApp, region?: string): void => {\n    try {\n      if(!_functions) {\n      const fns = getFunctions(app, region);\n      _functions = fns;\n    }\n  } catch (error) {\n      console.error(error);\n      _functions=null;\n    } finally {\n      return;\n    }\n}\n\n/**\n * Initializes and returns a fully configured Firebase instance.\n *\n * This utility function ensures that Firebase is initialized only once,\n * using the provided configuration. It returns the core Firebase services:\n * - Firebase App\n * - Authentication\n * - Firestore (with persistent multi-tab cache)\n * - Firebase Storage (only if a storageBucket is defined)\n * - 'callableFunction' (method that calls a Firebase \"callable function\" and returns the result)\n *\n * The function also includes optional console logs to help with debugging.\n *\n * @param configuration The Firebase configuration object (FirebaseOptions) plus Firebase region or your custom domain.\n * @param configuration.regionOrCustomDomain one of: a) The region the callable functions are located in (ex: us-central1) b) A custom domain hosting the callable functions (ex: https://mydomain.com) (optional but strongly recommended if it wasn't set with Firebase Context)\n * @param logs If true, logs each initialization step to the console (default: false).\n * @returns An object containing `app`, `auth`, `firestore`, and (optionally) `storage`.\n *\n * @throws If configuration is missing or Firebase was already initialized.\n *\n * @example\n * const firebaseContext = initializeFirebaseContext({\n *   apiKey: '...',\n *   authDomain: '...',\n *   projectId: '...',\n *   storageBucket: '...',\n *   regionOrCustomDomain: '...'\n * }, true);\n *\n * const auth = firebaseContext.auth;\n * const db = firebaseContext.firestore;\n * \n * const res = await firebaseContext.callableFunction(...);\n */\nexport const initializeFirebaseContext = (\n  configuration: ExtendedFirebaseOptions,\n  logs?: boolean\n): FirebaseInitializationContext => {\n  if (!configuration) throw new Error(\"Missing Firebase configuration\");\n\n  if(_context){\n    console.warn(\"Firebase app already initialized, returning active instance\");\n    return _context;\n  }\n\n  const apps: FirebaseApp[] = getApps();\n\n  let alreadyInitialized: boolean = false;\n\n  if (\n    apps &&\n    validate.array(apps) &&\n    validate.nonEmptyArray(apps) &&\n    apps.length > 0\n  )\n    alreadyInitialized = true;\n  if (alreadyInitialized) throw(\"Firebase app already initialized\");\n\n  const dev = isDev();\n\n  if (logs && dev) console.log(\"Initializing Firebase instances...\");\n\n  // Initialize Firebase\n  const app: FirebaseApp = alreadyInitialized\n    ? getApp()\n    : initializeApp(configuration);\n  if(logs && dev) console.log(\"Firebase app initialized\");\n\n  const auth: Auth = getAuth(app);\n  if(logs && dev) console.log(\"Firebase auth initialized\");\n\n  const storage: FirebaseStorage | undefined = configuration.storageBucket\n    ? getStorage(app)\n    : undefined;\n  if (logs && configuration.storageBucket)\n    console.log(\"Firebase storage initialized\");\n\n  const firestore: Firestore = initializeFirestore(app, {\n    localCache: persistentLocalCache({\n      tabManager: persistentMultipleTabManager(),\n    }),\n  });\n  if(logs && dev) console.log(\"Firebase firestore initialized\");\n\n  if(logs && dev) console.log(\"Firebase instances initialized successfully\");\n\n  if(logs && dev) console.log(\"Initializing Firebase client...\");\n\n  const client = initializeFirebaseClient({\n    auth,\n    firestore,\n    storage,\n  });\n\n  if(logs && dev) console.log(\"Firebase client initialization completed.\");\n\n  if(logs && dev) console.log(\"Initializing Firebase functions...\");\n  if(!_functions) initFunctions(app, configuration?.regionOrCustomDomain);\n  if(_functions && logs && dev) console.log(\"Firebase functions initialization completed.\");\n  if(!_functions && logs && dev) console.warn(\"Couldn't initialize Firebase functions.\");\n\n  const callableFunction = (functionName: string, options?: HttpsCallableOptions): HttpsCallable<unknown, unknown, unknown> | null => {\n    if(!_functions) initFunctions(app);\n    if(!_functions) return null;\n    const callable = httpsCallable(_functions, functionName, options);\n    return callable;\n  }\n\n  const context: FirebaseInitializationContext = {\n    app,\n    auth,\n    firestore,\n    storage,\n    client,\n    functions: {\n      get: ()=>_functions,\n      callable: callableFunction\n    }\n  };\n  if(logs && dev) console.log(\"Created Firebase context\");\n\n  _context=context;\n\n  return context;\n};\n","// backoff \"pulito\" (senza jitter): base * 2^(n-1), con cap\nexport const backoffNoJitter = (attempt: number, baseMin = 15, capMin = 240) =>\n  Math.min(capMin, baseMin * Math.pow(2, Math.max(0, attempt - 1)));\n\n// ±10% attorno al valore (equal jitter semplice)\nexport const addJitter = (minutes: number, ratio = 0.10) => {\n  const min = minutes * (1 - ratio);\n  const max = minutes * (1 + ratio);\n  return Math.round(min + Math.random() * (max - min));\n};\n\n// Full jitter: scegli un valore casuale tra 0 e il backoff calcolato\nexport const fullJitter = (attempt: number, baseMin = 15, capMin = 240) => {\n  const d = backoffNoJitter(attempt, baseMin, capMin);\n  return Math.round(Math.random() * d);\n};\n\n// Decorrelated jitter (richiede il delay precedente)\nexport const decorrelatedJitter = (prevMin: number, baseMin = 15, capMin = 240) => {\n  const next = Math.min(capMin, Math.max(baseMin, Math.random() * (prevMin * 3)));\n  return Math.round(next);\n};\n","// numberUtils.ts\n\n// ---------- Branding ----------\nexport type Brand<Base, Tag extends string> = Base & { readonly __brand: Tag };\n\n// Branded number types\nexport type U8  = Brand<number, \"u8\">;\nexport type U16 = Brand<number, \"u16\">;\nexport type U32 = Brand<number, \"u32\">;\nexport type U64 = Brand<number, \"u64\">;\nexport type I8  = Brand<number, \"i8\">;\nexport type I16 = Brand<number, \"i16\">;\nexport type I32 = Brand<number, \"i32\">;\nexport type I64 = Brand<number, \"i64\">;\nexport type F32 = Brand<number, \"f32\">;\nexport type F64 = Brand<number, \"f64\">;\n\n// ---------- Predicates ----------\nexport type NumberPredicate = (v: unknown) => v is number;\n\nexport interface NumPredicates {\n  // Unsigned\n  isU8: NumberPredicate;\n  isU16: NumberPredicate;\n  isU32: NumberPredicate;\n  isU64: NumberPredicate;\n  // Signed\n  isI8: NumberPredicate;\n  isI16: NumberPredicate;\n  isI32: NumberPredicate;\n  isI64: NumberPredicate;\n  // Floats\n  isF32: NumberPredicate;\n  isF64: NumberPredicate;\n}\n\n// ---------- Refinement API ----------\nexport interface Refinement<TBrand extends string> {\n  /** Type guard verso il tipo brandizzato */\n  is(v: unknown): v is Brand<number, TBrand>;\n  /** Costruttore che valida e lancia su input invalido */\n  as(v: unknown): Brand<number, TBrand>;\n  /** Costruttore “safe” che restituisce null se non valido */\n  try(v: unknown): Brand<number, TBrand> | null;\n  /** Parser da stringa (usa Number), valida e lancia su input invalido */\n  parse(s: string): Brand<number, TBrand>;\n}\n\n// ---------- Oggetto pubblico Num (tipizzato) ----------\nexport interface NumAPI extends NumPredicates {\n  U8:  Refinement<\"u8\">;\n  U16: Refinement<\"u16\">;\n  U32: Refinement<\"u32\">;\n  U64: Refinement<\"u64\">;\n  I8:  Refinement<\"i8\">;\n  I16: Refinement<\"i16\">;\n  I32: Refinement<\"i32\">;\n  I64: Refinement<\"i64\">;\n  F32: Refinement<\"f32\">;\n  F64: Refinement<\"f64\">;\n}\n\n// ---------- Runtime helpers ----------\nfunction isIntegerInRange(v: unknown, min: number, max: number): v is number {\n  return typeof v === \"number\" && Number.isInteger(v) && v >= min && v <= max;\n}\nfunction isF32Runtime(v: unknown): v is number {\n  return typeof v === \"number\" && Math.fround(v) === v;\n}\n\n// Predicati tipizzati e riusabili\nexport const Pred: Readonly<NumPredicates> = {\n  // Unsigned\n  isU8:  (v): v is number => isIntegerInRange(v, 0, 0xFF),\n  isU16: (v): v is number => isIntegerInRange(v, 0, 0xFFFF),\n  isU32: (v): v is number => isIntegerInRange(v, 0, 0xFFFFFFFF),\n  isU64: (v): v is number => isIntegerInRange(v, 0, Number.MAX_SAFE_INTEGER),\n\n  // Signed\n  isI8:  (v): v is number => isIntegerInRange(v, -0x80, 0x7F),\n  isI16: (v): v is number => isIntegerInRange(v, -0x8000, 0x7FFF),\n  isI32: (v): v is number => isIntegerInRange(v, -0x80000000, 0x7FFFFFFF),\n  isI64: (v): v is number =>\n    typeof v === \"number\" &&\n    Number.isInteger(v) &&\n    v >= Number.MIN_SAFE_INTEGER &&\n    v <= Number.MAX_SAFE_INTEGER,\n\n  // Floats\n  isF32: (v): v is number => isF32Runtime(v),\n  isF64: (v): v is number => typeof v === \"number\",\n} as const;\n\n// Factory per i refinements\nfunction makeRefinement<TBrand extends string>(\n  tag: TBrand,\n  isFn: NumberPredicate\n): Refinement<TBrand> {\n  return {\n    is: (v): v is Brand<number, TBrand> => isFn(v),\n    as: (v) => {\n      if (!isFn(v)) throw new TypeError(`Expected ${tag}, got ${String(v)}`);\n      return v as Brand<number, TBrand>;\n    },\n    try: (v) => (isFn(v) ? (v as Brand<number, TBrand>) : null),\n    parse: (s) => {\n      const n = Number(s);\n      if (!Number.isFinite(n) || !isFn(n)) {\n        throw new TypeError(`Invalid ${tag} from \"${s}\"`);\n      }\n      return n as Brand<number, TBrand>;\n    },\n  };\n}\n\n// Implementazione + tipizzazione esplicita\nexport const Num: NumAPI = {\n  // Predicates (stile number.is...)\n  isU8: Pred.isU8,\n  isU16: Pred.isU16,\n  isU32: Pred.isU32,\n  isU64: Pred.isU64,\n  isI8: Pred.isI8,\n  isI16: Pred.isI16,\n  isI32: Pred.isI32,\n  isI64: Pred.isI64,\n  isF32: Pred.isF32,\n  isF64: Pred.isF64,\n\n  // Branded constructors / refiners\n  U8:  makeRefinement(\"u8\",  Pred.isU8),\n  U16: makeRefinement(\"u16\", Pred.isU16),\n  U32: makeRefinement(\"u32\", Pred.isU32),\n  U64: makeRefinement(\"u64\", Pred.isU64),\n  I8:  makeRefinement(\"i8\",  Pred.isI8),\n  I16: makeRefinement(\"i16\", Pred.isI16),\n  I32: makeRefinement(\"i32\", Pred.isI32),\n  I64: makeRefinement(\"i64\", Pred.isI64),\n  F32: makeRefinement(\"f32\", Pred.isF32),\n  F64: makeRefinement(\"f64\", Pred.isF64),\n};\n","// jsonTools.ts\n// --- All comments are in English as requested ---\n\nimport Ajv, { AnySchema, DefinedError } from \"ajv\";\nimport addFormats from \"ajv-formats\";\nimport { validate as _validate } from \"./_typesValidation\";\n\n/**\n * A parsed JSON validation result: either success with data, or failure with readable errors.\n * @template T Parsed JSON value type (defaults to unknown)\n * @property {true} ok Indicates success\n * @property {T} data Parsed JSON value\n */\n/**\n * @template T\n * @typedef {object} Ok\n * @property {true} ok\n * @property {T} data\n */\n\n/**\n * A parsed JSON validation failure result.\n * @property {false} ok Indicates failure\n * @property {string[]} errors Human-readable error messages\n */\n/**\n * @typedef {object} Err\n * @property {false} ok\n * @property {string[]} errors\n */\n\n/**\n * Union result type for validation outcomes.\n * @template T\n * @typedef {(Ok<T> | Err)} ValidationResult\n */\n\n/** Global singleton Ajv to avoid recompilation overhead */\nconst ajv = new Ajv({\n  allErrors: true, // richer error messages\n  strict: false    // plays nice with draft-07 and relaxed schemas\n});\naddFormats(ajv);\n\n/** Cache compiled validators per schema object for efficiency */\nconst validatorCache = new WeakMap<object, (data: unknown) => boolean>();\n\n/**\n * A small toolkit for working with JSON strings.\n *\n * @remarks\n * - The only exported API is this default object `jsonTools`.\n * - All functions are documented with JSDoc so tooltips are shown in IDEs.\n */\nconst jsonTools = {\n  /**\n   * Validate a JSON string.\n   *\n   * - If `schema` is **omitted**: only checks that the string is valid JSON and returns the parsed value.\n   * - If `schema` is **provided** (object/boolean or JSON string): validates against the schema using Ajv.\n   *\n   * @template T\n   * @param {string} jsonStr The JSON string to parse.\n   * @param {AnySchema | string} [schema] Optional JSON Schema as an object/boolean or as a JSON string.\n   * @returns {ValidationResult<T>} On success, `{ ok: true, data }`; on failure, `{ ok: false, errors }`.\n   *\n   * @example\n   * // Just check if it's valid JSON\n   * const r1 = jsonTools.validate('{\"a\":1}');\n   * if (r1.ok) {\n   *   // r1.data is the parsed value\n   *   console.log(r1.data);\n   * }\n   *\n   * @example\n   * // Validate against a schema (object)\n   * const schema = {\n   *   type: \"object\",\n   *   required: [\"a\"],\n   *   properties: { a: { type: \"number\" } },\n   *   additionalProperties: false\n   * } as const;\n   * const r2 = jsonTools.validate<{ a: number }>('{\"a\":1}', schema);\n   * console.log(r2.ok ? \"valid\" : r2.errors.join(\"\\\\n\"));\n   *\n   * @example\n   * // Validate against a schema (string)\n   * const schemaStr = JSON.stringify({ type: \"array\", items: { type: \"string\" } });\n   * const r3 = jsonTools.validate<string[]>('[\"x\",\"y\"]', schemaStr);\n   * if (r3.ok) console.log(r3.data.length);\n   */\n  validate<T = unknown>(\n    jsonStr: string,\n    schema?: AnySchema | string\n  ):\n    | { ok: true; data: T }\n    | { ok: false; errors: string[] } {\n    // 1) Parse the JSON safely\n    let parsed: unknown;\n    let isValidJSON: boolean=false;\n    let notValidJSONError: unknown;\n    try {\n      parsed = JSON.parse(jsonStr);\n      isValidJSON = _validate.jsonString(jsonStr);\n    } catch (err) {\n      isValidJSON = false;\n      notValidJSONError = err;\n    } finally {\n        if(!isValidJSON) {\n            let e = notValidJSONError;\n            return {\n                ok: false,\n                errors: [\"JSON malformato: \" + (e instanceof Error ? e.message : String(e))]\n            };\n        }\n    }\n\n    // 2) If no schema, parsing success is enough\n    if (schema === undefined) {\n      return { ok: true, data: parsed as T };\n    }\n\n    // 3) Normalize schema (accept object/boolean or JSON string)\n    let normalizedSchema: AnySchema;\n    if (typeof schema === \"string\") {\n      try {\n        normalizedSchema = JSON.parse(schema) as AnySchema;\n      } catch (e) {\n        return {\n          ok: false,\n          errors: [\n            \"Schema malformato (non è JSON valido): \" +\n              (e instanceof Error ? e.message : String(e))\n          ]\n        };\n      }\n    } else {\n      normalizedSchema = schema;\n    }\n\n    // 4) Compile (with cache) and validate\n    let validateFn: ((data: unknown) => boolean) | undefined;\n\n    if (normalizedSchema && typeof normalizedSchema === \"object\") {\n      validateFn = validatorCache.get(normalizedSchema as object);\n      if (!validateFn) {\n        validateFn = ajv.compile(normalizedSchema);\n        validatorCache.set(normalizedSchema as object, validateFn);\n      }\n    } else {\n      // boolean schemas (true/false) or non-object: compile directly (no cache)\n      validateFn = ajv.compile(normalizedSchema);\n    }\n\n    const isValid = validateFn(parsed);\n    if (isValid) {\n      return { ok: true, data: parsed as T };\n    }\n\n    // 5) Collect and format Ajv errors\n    const ajvErrors = (validateFn as any).errors as DefinedError[] | null | undefined;\n    const errors =\n      ajvErrors?.map((err) => {\n        const path = err.instancePath || \"(root)\";\n        const keyword = err.keyword;\n        const msg = err.message || \"schema validation error\";\n        const params = err.params ? JSON.stringify(err.params) : \"\";\n        return `${path} – ${keyword}: ${msg}${params ? ` ${params}` : \"\"}`;\n      }) ?? [\"Schema validation failed (unknown error)\"];\n\n    return { ok: false, errors };\n  }\n} as const;\n\nexport default jsonTools;"],"mappings":"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","names":["isLocalhost","hash","query","target","doc","get","ref","collection","Timestamp","getApp","getApps","getApps","dev","getApp","client"]}